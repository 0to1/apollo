"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[753],{97790:(e,t,r)=>{r.r(t),r.d(t,{default:()=>P});var n=r(21902),i=r(45994),a=r(4022),o=r(44606);function c(){return(0,o.BH)((function(e){return{"panel-camera-root":{position:"relative",height:"100%",width:"100%",display:"flex",justifyContent:"center",alignItems:"center"},"camera-btn-container":{position:"absolute",bottom:"24px",right:"24px"},"camera-btn-item":{display:"inline-block",cursor:"pointer",textAlign:"center",width:"32px",height:"32px",lineHeight:"32px",background:"#343C4D",borderRadius:"6px",marginTop:"12px",fontSize:"16px"},"camera-canvas-container":{width:"100%",height:"100%",maxWidth:"100%",maxHeight:"100%",display:"flex",justifyContent:"center",alignItems:"center"},"panel-camera-canvas":{},"layer-menu-container":{width:"158px",height:"94px"},"layer-menu-header":{height:"40px",paddingLeft:"24px",display:"flex",alignItems:"center",borderBottom:"1px solid #383B45",fontFamily:"PingFangSC-Medium",fontSize:"16px",color:"#FFFFFF",fontWeight:"500"},"layer-menu-content-right":{height:"54px",paddingLeft:"24px",display:"flex",alignItems:"center",fontFamily:"PingFangSC-Regular",fontSize:"14px",color:"#A6B5CC",fontWeight:"400"}}}))()}var l=r(52007),u=new Map([["ST_UNKNOWN","rgba(96, 96, 96, 1.000)"],["ST_UNKNOWN_MOVABLE","rgba(96, 96, 96, 1.000)"],["ST_UNKNOWN_UNMOVABLE","rgba(96, 96, 96, 1.000)"],["ST_CAR","rgba(243, 187, 37, 1.000)"],["ST_VAN","rgba(243, 187, 37, 1.000)"],["ST_TRUCK","rgba(243, 187, 37, 1.000)"],["ST_BUS","rgba(243, 187, 37, 1.000)"],["ST_CYCLIST","rgba(231, 91, 135, 1.000)"],["ST_MOTORCYCLIST","rgba(231, 91, 135, 1.000)"],["ST_TRICYCLIST","rgba(231, 91, 135, 1.000)"],["ST_PEDESTRIAN","#35DACF"],["ST_TRAFFICCONE","#35DACF"]]),s=r(54067),f={"":{boundingbox:{defaultVisible:!1,currentVisible:!1,vizKey:"Boundingbox"}}};function h(e){return h="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},h(e)}function d(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function p(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?d(Object(r),!0).forEach((function(t){m(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):d(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function m(e,t,r){return(t=function(e){var t=function(e,t){if("object"!==h(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,"string");if("object"!==h(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===h(t)?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function y(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,i,a,o,c=[],l=!0,u=!1;try{if(a=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=a.call(r)).done)&&(c.push(n.value),c.length!==t);l=!0);}catch(e){u=!0,i=e}finally{try{if(!l&&null!=r.return&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw i}}return c}}(e,t)||function(e,t){if(e){if("string"==typeof e)return b(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?b(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function b(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function g(e){var t=e.setShowBoundingBox,r=c(),a=r.classes,o=r.cx,l=(0,s.$G)("layerMenu").t,u=y((0,n.useState)(f),2),h=u[0],d=u[1],b=y((0,n.useState)(Object.keys(h)),1)[0],g=y((0,n.useState)(b[0]),2),v=g[0],w=g[1],O=y((0,n.useState)(h[v]),2),S=O[0],E=O[1];return n.createElement("div",{className:a["layer-menu-container"]},n.createElement("div",{className:a["layer-menu-header"]},n.createElement("div",{className:a["layer-menu-header-left"]},l("layerMenu")),n.createElement("div",{className:a["layer-menu-header-right"]})),n.createElement("div",{className:a["layer-menu-content"]},n.createElement("div",{className:a["layer-menu-content-left"]},b.map((function(e){return n.createElement("li",{key:e,className:o(a["layer-menu-content-left-li"],m({},a["li-active"],v===e)),onClick:function(){w(e),E(h[e])}},n.createElement("span",null,e))}))),n.createElement("div",{className:a["layer-menu-content-right"]},Object.keys(S).map((function(e){var r=h[v][e].currentVisible;return n.createElement("li",{key:e},n.createElement("span",null,n.createElement(i.XZ,{checked:r,defaultChecked:r,onChange:function(r){var n=r.target.checked;t(n);var i=p(p({},h[v]),{},m({},e,p(p({},h[v][e]),{},{currentVisible:n}))),a=p(p({},h),{},m({},v,i));E((function(){return i})),d((function(){return a}))}},e)))})))))}const v=n.memo(g);var w=r(58938),O=r(2629),S=r(86944);function E(e){return E="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},E(e)}function x(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,i,a,o,c=[],l=!0,u=!1;try{if(a=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=a.call(r)).done)&&(c.push(n.value),c.length!==t);l=!0);}catch(e){u=!0,i=e}finally{try{if(!l&&null!=r.return&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw i}}return c}}(e,t)||function(e,t){if(e){if("string"==typeof e)return R(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?R(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function R(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function j(){var e=(0,l.R)(),t=e.logger,r=e.panelId,o=(e.data,e.onPanelResize),s=e.initSubscription,f=x((0,n.useState)(!1),2),h=f[0],d=f[1],p=x((0,n.useState)(null),2),m=p[0],y=p[1],b=x((0,n.useState)(),2),g=b[0],O=b[1],R=(0,n.useRef)(null);(0,n.useEffect)((function(){var e,t,r;s((e={},t=w.DU.CAMERA,r={consumer:function(e){O(e)}},(t=function(e){var t=function(e,t){if("object"!==E(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,"string");if("object"!==E(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===E(t)?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e))}),[]),(0,n.useLayoutEffect)((function(){o((function(e,t){y({viewPortWidth:e,viewPortHeight:t})}))}),[]),(0,n.useEffect)((function(){var e;if(!(0,a.isEmpty)(g)&&(null==g||null===(e=g.image)||void 0===e?void 0:e.length)>0){var n=g.kImageScale,i=new Uint8Array(g.image),o=new Blob([i],{type:"image/jpeg"});createImageBitmap(o).then((function(e){var i=R.current;if(i){var a={},o=e.width/e.height>m.viewPortWidth/m.viewPortHeight,c=m.viewPortWidth/e.width,l=m.viewPortHeight/e.height,s=o?c:l;a.drawImageWidth=e.width*s,a.drawImageHeight=e.height*s,i.width=a.drawImageWidth,i.height=a.drawImageHeight;var f=i.getContext("2d");f.drawImage(e,0,0,a.drawImageWidth,a.drawImageHeight),g.bbox2d&&g.bbox2d.length>0&&h&&(t.debug(r,"has obstacles"),g.bbox2d.forEach((function(e,i){var a=g.obstaclesId[i],o=g.obstaclesSubType[i];f.strokeStyle=u.get(o)||"red";var c=e.xmin,l=e.ymin,h=e.xmax,d=e.ymax;if(c!==l||l!==h||h!==d){var p=x([c,l,h,d].map((function(e){return e*(null!=n?n:1)*s})),4);c=p[0],l=p[1],h=p[2],d=p[3],f.strokeRect(c,l,h-c,d-l),f.fillStyle=u.get(o)||"white",f.font="12px Arial",f.fillText("".concat(o.substring(3),":").concat(a),c,l)}else t.debug(r,"bbox is empty")})))}})).catch((function(e){t.error(e)}))}}),[g,h,m]);var j=c().classes;return n.createElement("div",{className:j["panel-camera-root"]},n.createElement("div",{className:j["camera-btn-container"]},n.createElement(i.J2,{placement:"leftTop",content:n.createElement(v,{setShowBoundingBox:d}),trigger:"click"},n.createElement("span",{className:j["camera-btn-item"]},n.createElement(i.Le,null)))),n.createElement(S.Z,{className:j["camera-canvas-container"]},n.createElement("canvas",{ref:R,id:"camera-".concat(r),className:j["panel-camera-canvas"]})))}function C(e){var t=(0,n.useMemo)((function(){return(0,O.Z)({PanelComponent:j,panelId:e.panelId,subscribeInfo:[{name:w.DU.CAMERA,needChannel:!0}]})}),[]);return n.createElement(t,e)}j.displayName="InternalCameraView";const P=n.memo(C)},57795:(e,t,r)=>{r.d(t,{NB:()=>m});var n=r(21902),i=r(5350),a=r(59741),o=r.n(a),c=r(35220),l=r.n(c),u=function(e,t){return u=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])},u(e,t)};var s=function(){return s=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var i in t=arguments[r])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},s.apply(this,arguments)};var f=function(e,t,r,n){switch(t){case"debounce":return o()(e,r,n);case"throttle":return l()(e,r,n);default:return e}},h=function(e){return"function"==typeof e},d=function(){return"undefined"==typeof window},p=function(e){return e instanceof Element||e instanceof HTMLDocument};function m(e){var t=void 0===e?{}:e,r=t.skipOnMount,i=void 0!==r&&r,a=t.refreshMode,o=t.refreshRate,c=void 0===o?1e3:o,l=t.refreshOptions,u=t.handleWidth,h=void 0===u||u,d=t.handleHeight,p=void 0===d||d,m=t.targetRef,y=t.observerOptions,b=t.onResize,g=(0,n.useRef)(i),v=(0,n.useState)({width:void 0,height:void 0}),w=v[0],O=v[1],S=(0,n.useState)((null==m?void 0:m.current)||null),E=S[0],x=S[1];m&&setTimeout((function(){m.current!==E&&x(m.current)}),0);var R=(0,n.useCallback)((function(e){e!==E&&x(e)}),[E]);R.current=E,(0,n.useEffect)((function(){return function(){x(null),R.current=null}}),[]);var j=(0,n.useCallback)((function(e,t){return(e.width!==t.width||e.height!==t.height)&&!(e.width===t.width&&!p||e.height===t.height&&!h)}),[h,p]),C=(0,n.useCallback)((function(e){(h||p)&&(g.current?g.current=!1:e.forEach((function(e){var t=(null==e?void 0:e.contentRect)||{},r=t.width,n=t.height;O((function(e){return j(e,{width:r,height:n})?{width:r,height:n}:e}))})))}),[h,p,g,j]),P=(0,n.useCallback)(f(C,a,c,l),[C,a,c,l]);return(0,n.useEffect)((function(){var e;return E?(e=new window.ResizeObserver(P)).observe(E,y):(w.width||w.height)&&O({width:void 0,height:void 0}),function(){var t,r,n;null===(t=null==e?void 0:e.disconnect)||void 0===t||t.call(e),null===(n=(r=P).cancel)||void 0===n||n.call(r)}}),[P,E]),(0,n.useEffect)((function(){null==b||b(w.width,w.height)}),[w]),s({ref:R},w)}!function(e){function t(t){var r=e.call(this,t)||this;r.cancelHandler=function(){r.resizeHandler&&r.resizeHandler.cancel&&(r.resizeHandler.cancel(),r.resizeHandler=null)},r.attachObserver=function(){var e=r.props,t=e.targetRef,n=e.observerOptions;if(!d()){t&&t.current&&(r.targetRef.current=t.current);var i=r.getElement();i&&(r.observableElement&&r.observableElement===i||(r.observableElement=i,r.resizeObserver.observe(i,n)))}},r.getElement=function(){var e=r.props,t=e.querySelector,n=e.targetDomEl;if(d())return null;if(t)return document.querySelector(t);if(n&&p(n))return n;if(r.targetRef&&p(r.targetRef.current))return r.targetRef.current;var a=(0,i.findDOMNode)(r);if(!a)return null;switch(r.getRenderType()){case"renderProp":case"childFunction":case"child":case"childArray":return a;default:return a.parentElement}},r.createResizeHandler=function(e){var t=r.props,n=t.handleWidth,i=void 0===n||n,a=t.handleHeight,o=void 0===a||a,c=t.onResize;(i||o)&&e.forEach((function(e){var t=e&&e.contentRect||{},n=t.width,a=t.height;!r.skipOnMount&&!d()&&function(e){var t=e.width,n=e.height;r.state.width===t&&r.state.height===n||r.state.width===t&&!o||r.state.height===n&&!i||(null==c||c(t,n),r.setState({width:t,height:n}))}({width:n,height:a}),r.skipOnMount=!1}))},r.getRenderType=function(){var e=r.props,t=e.render,i=e.children;return h(t)?"renderProp":h(i)?"childFunction":(0,n.isValidElement)(i)?"child":Array.isArray(i)?"childArray":"parent"};var a=t.skipOnMount,o=t.refreshMode,c=t.refreshRate,l=void 0===c?1e3:c,u=t.refreshOptions;return r.state={width:void 0,height:void 0},r.sizeRef={current:r.state},r.skipOnMount=a,r.targetRef=(0,n.createRef)(),r.observableElement=null,d()||(r.resizeHandler=f(r.createResizeHandler,o,l,u),r.resizeObserver=new window.ResizeObserver(r.resizeHandler)),r}(function(e,t){function r(){this.constructor=e}u(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)})(t,e),t.prototype.componentDidMount=function(){this.attachObserver()},t.prototype.componentDidUpdate=function(){this.attachObserver(),this.sizeRef.current=this.state},t.prototype.componentWillUnmount=function(){d()||(this.observableElement=null,this.resizeObserver.disconnect(),this.cancelHandler())},t.prototype.render=function(){var e=this.props,t=e.render,r=e.children,i=e.nodeType,a=void 0===i?"div":i,o=this.state,c={width:o.width,height:o.height,targetRef:this.targetRef};switch(this.getRenderType()){case"renderProp":return null==t?void 0:t(c);case"childFunction":return null==r?void 0:r(c);case"child":var l=r;if(l.type&&"string"==typeof l.type){var u=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(r[n[i]]=e[n[i]])}return r}(c,["targetRef"]);return(0,n.cloneElement)(l,u)}return(0,n.cloneElement)(l,c);case"childArray":return r.map((function(e){return!!e&&(0,n.cloneElement)(e,c)}));default:return n.createElement(a,null)}}}(n.PureComponent)}}]);