"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[409],{92606:(e,t,n)=>{n.r(t),n.d(t,{default:()=>Mt});var r=n(21902),o=n(76208),i=n(45994),a=n(97265),l=n.n(a);function c(e){return c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},c(e)}function u(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function s(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?u(Object(n),!0).forEach((function(t){var r,o,i;r=e,o=t,i=n[t],(o=function(e){var t=function(e,t){if("object"!==c(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==c(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===c(t)?t:String(t)}(o))in r?Object.defineProperty(r,o,{value:i,enumerable:!0,configurable:!0,writable:!0}):r[o]=i})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):u(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function f(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i,a,l=[],c=!0,u=!1;try{if(i=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=i.call(n)).done)&&(l.push(r.value),l.length!==t);c=!0);}catch(e){u=!0,o=e}finally{try{if(!c&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}(e,t)||function(e,t){if(e){if("string"==typeof e)return m(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?m(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function m(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var p=(0,r.createContext)(void 0),y=function(e){var t=e.initialPath,n=void 0===t?"/":t,o=e.children,i=f((0,r.useState)(n),2),a=i[0],l=i[1],c=(0,r.useMemo)((function(){return{currentPath:a,navigate:l}}),[a]);return r.createElement(p.Provider,{value:c},o)},d=function(e){var t=e.path,n=e.children,o=(0,r.useContext)(p);if(!o)throw new Error("Route must be used within SimpleRouter");return o.currentPath===t?r.createElement(r.Fragment,null,n):null},v=function(){var e=(0,r.useContext)(p);if(!e)throw new Error("useNavigate must be used within SimpleRouter");return e.navigate},b=function(e){var t=e.path,n=e.style,o=e.children,i=(0,r.useContext)(p);if(!i)throw new Error("KeepAlive must be used within SimpleRouter");var a=i.currentPath===t,l=f((0,r.useState)(!1),2),c=l[0],u=l[1];return(0,r.useEffect)((function(){a&&u(!0)}),[a]),c?r.createElement("div",{style:s(s({},n),{},{display:a?"block":"none"})},o):null},g=n(80151),h=n(58938),E=n(56733),w=n(54067),O={Perception:{polygon:{defaultVisible:!0,currentVisible:!0,vizKey:"polygon"},boundingbox:{defaultVisible:!1,currentVisible:!1,vizKey:"boundingbox"},pointCloud:{defaultVisible:!1,currentVisible:!1,vizKey:"pointCloud"},unknownMovable:{defaultVisible:!0,currentVisible:!0,vizKey:"unknownMovable"},vehicle:{defaultVisible:!0,currentVisible:!0,vizKey:"vehicle"},unknownStationary:{defaultVisible:!0,currentVisible:!0,vizKey:"unknownUnMovable"},pedestrian:{defaultVisible:!0,currentVisible:!0,vizKey:"pedestrian"},unknown:{defaultVisible:!0,currentVisible:!0,vizKey:"unknown"},bicycle:{defaultVisible:!0,currentVisible:!0,vizKey:"bicycle"},cipv:{defaultVisible:!0,currentVisible:!0,vizKey:"cipv"},velocity:{defaultVisible:!0,currentVisible:!0,vizKey:"obstacleVelocity"},heading:{defaultVisible:!0,currentVisible:!0,vizKey:"obstacleHeading"},id:{defaultVisible:!0,currentVisible:!0,vizKey:"obstacleId"},distanceAndSpeed:{defaultVisible:!0,currentVisible:!0,vizKey:"obstacleDistanceAndSpeed"},laneMarker:{defaultVisible:!1,currentVisible:!1,vizKey:"laneMarker"},lidarSensor:{defaultVisible:!1,currentVisible:!1,vizKey:"lidarSensor"},radarSensor:{defaultVisible:!1,currentVisible:!1,vizKey:"radarSensor"},cameraSensor:{defaultVisible:!1,currentVisible:!1,vizKey:"cameraSensor"},v2x:{defaultVisible:!1,currentVisible:!1,vizKey:"v2x"}},Prediction:{priority:{defaultVisible:!0,currentVisible:!0,vizKey:"obstaclePriority"},majorPredictionLine:{defaultVisible:!0,currentVisible:!0,vizKey:"majorPredictionLine"},gaussianInfo:{defaultVisible:!1,currentVisible:!1,vizKey:"gaussianInfo"},minorPredictionLine:{defaultVisible:!0,currentVisible:!0,vizKey:"minorPredictionLine"},interactiveTag:{defaultVisible:!0,currentVisible:!0,vizKey:"obstacleInteractiveTag"}},Routing:{routingLine:{defaultVisible:!0,currentVisible:!0,vizKey:"routingLine"}},Decision:{mainDecision:{defaultVisible:!0,currentVisible:!0,vizKey:"mainDecision"},obstacleDecision:{defaultVisible:!0,currentVisible:!0,vizKey:"obstacleDecision"}},Planning:{planningCar:{defaultVisible:!1,currentVisible:!1,vizKey:"planningCar"},planningTrajectory:{defaultVisible:!0,currentVisible:!0,vizKey:"planningTrajectory"}},Position:{localization:{defaultVisible:!0,currentVisible:!0,vizKey:"localization"},gps:{defaultVisible:!1,currentVisible:!1,vizKey:"gps"},shadow:{defaultVisible:!1,currentVisible:!1,vizKey:"shadow"}},Map:{crosswalk:{defaultVisible:!0,currentVisible:!0,vizKey:"crosswalk"},clearArea:{defaultVisible:!0,currentVisible:!0,vizKey:"clearArea"},junction:{defaultVisible:!1,currentVisible:!1,vizKey:"junction"},pncJunction:{defaultVisible:!1,currentVisible:!1,vizKey:"pncJunction"},lane:{defaultVisible:!0,currentVisible:!0,vizKey:"lane"},road:{defaultVisible:!1,currentVisible:!1,vizKey:"road"},signal:{defaultVisible:!0,currentVisible:!0,vizKey:"signal"},stopSign:{defaultVisible:!0,currentVisible:!0,vizKey:"stopSign"},yieldSign:{defaultVisible:!0,currentVisible:!0,vizKey:"yieldSign"},speedBump:{defaultVisible:!0,currentVisible:!0,vizKey:"speedBump"},parkingSpace:{defaultVisible:!0,currentVisible:!0,vizKey:"parkingSpace"},parkingSpaceId:{defaultVisible:!1,currentVisible:!1,vizKey:"parkingSpaceId"},laneId:{defaultVisible:!1,currentVisible:!1,vizKey:"laneId"}}},S=function(e){var t={};return Object.keys(e).forEach((function(n){var r=e[n];Object.keys(r).forEach((function(e){var o=r[e];t[n]=t[n]||{},t[n][o.vizKey]=o.currentVisible}))})),t},x=function(){var e=localStorage.getItem("layerMenuParams");return e?JSON.parse(e):O},P=n(52007),C=n(16125);function j(e){return j="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},j(e)}function R(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function N(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?R(Object(n),!0).forEach((function(t){k(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):R(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function k(e,t,n){return(t=function(e){var t=function(e,t){if("object"!==j(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==j(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===j(t)?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function I(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i,a,l=[],c=!0,u=!1;try{if(i=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=i.call(n)).done)&&(l.push(r.value),l.length!==t);c=!0);}catch(e){u=!0,o=e}finally{try{if(!c&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}(e,t)||function(e,t){if(e){if("string"==typeof e)return A(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?A(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function A(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function F(e){var t,n,o=(0,E.Z)(),a=o.classes,l=o.cx,c=e.carviz,u=e.pointCloudFusionChannel,s=(0,w.$G)("layerMenu").t,f=(0,P.R)(),m=f.updateChannel,p=f.closeSubcription,y=(0,C.Z)().metadata,d=(0,r.useCallback)((function(e){if("pointCloud"===e){var t,n=null===(t=y.find((function(e){return e.dataName===h.DU.POINT_CLOUD})))||void 0===t?void 0:t.channels;if(Array.isArray(n)){var r=n.some((function(e){return e.includes("compensator")})),o=n.some((function(e){return e.includes("fusion")}));return!(r||o)}}return!1}),[y]),v=x();localStorage.setItem("layerMenuParams",JSON.stringify(v)),c.option.updateLayerOption(S(v),"vehicle");var b=I((0,r.useState)(v),2),g=b[0],j=b[1],R=I((0,r.useState)(Object.keys(g)),1)[0],A=I((0,r.useState)(R[0]),2),F=A[0],M=A[1],T=I((0,r.useState)(g[F]),2),V=T[0],L=T[1];return r.createElement("div",{className:a["layer-menu-container"]},r.createElement("div",{className:a["layer-menu-header"]},r.createElement("div",{className:a["layer-menu-header-left"]},s("layerMenu")),r.createElement("div",{className:a["layer-menu-header-right"]},r.createElement("div",{className:a["layer-menu-header-reset-btn"],onClick:function(){j((function(){return O})),c.option.updateLayerOption(S(O),"vehicle"),localStorage.setItem("layerMenuParams",JSON.stringify(O))}},s("restoreDefaultSettings")))),r.createElement("div",{className:a["layer-menu-content"]},r.createElement("div",{className:a["layer-menu-content-left"]},R.map((function(e){return r.createElement("li",{key:e,className:l(a["layer-menu-content-left-li"],k({},a["li-active"],F===e)),onClick:function(){M(e),L(g[e])}},r.createElement("span",null,s(e)))}))),r.createElement("div",{className:a["layer-menu-content-right"]},"Perception"===F&&r.createElement(r.Fragment,null,r.createElement("li",{className:a["layer-menu-content-right-li"]},r.createElement("span",{className:a["layer-menu-content-right-switch"]},r.createElement(i.Y8,{checked:null==g||null===(t=g.Perception)||void 0===t||null===(t=t.polygon)||void 0===t?void 0:t.currentVisible,onChange:function(e){if(e.target.checked){var t=N(N({},g.Perception),{},{polygon:N(N({},g.Perception.polygon),{},{currentVisible:!0}),boundingbox:N(N({},g.Perception.boundingbox),{},{currentVisible:!1})}),n=N(N({},g),{},k({},F,t));L((function(){return t})),j((function(){return n})),c.option.updateLayerOption(S(n),"vehicle"),localStorage.setItem("layerMenuParams",JSON.stringify(n))}}})),r.createElement("span",{className:a["layer-menu-content-right-label"]},s("polygon"))),r.createElement("li",{className:a["layer-menu-content-right-li"]},r.createElement("span",{className:a["layer-menu-content-right-switch"]},r.createElement(i.Y8,{checked:null==g||null===(n=g.Perception)||void 0===n||null===(n=n.boundingbox)||void 0===n?void 0:n.currentVisible,onChange:function(e){if(e.target.checked){var t=N(N({},g.Perception),{},{polygon:N(N({},g.Perception.polygon),{},{currentVisible:!1}),boundingbox:N(N({},g.Perception.boundingbox),{},{currentVisible:!0})}),n=N(N({},g),{},k({},F,t));L((function(){return t})),j((function(){return n})),c.option.updateLayerOption(S(n),"vehicle"),localStorage.setItem("layerMenuParams",JSON.stringify(n))}}})),r.createElement("span",{className:a["layer-menu-content-right-label"]},s("boundingbox"))),r.createElement("div",{className:a["layer-menu-horizontal-line"]})),Object.keys(V).map((function(e){var t=(g[F][e]||{}).currentVisible;return"polygon"!==e&&"boundingbox"!==e&&r.createElement("li",{className:a["layer-menu-content-right-li"],key:e},r.createElement("span",{className:a["layer-menu-content-right-switch"]},r.createElement(i.XZ,{checked:t,disabled:d(e),defaultChecked:t,onChange:function(t){var n=t.target.checked,r=N(N({},g[F]),{},k({},e,N(N({},g[F][e]),{},{currentVisible:n}))),o=N(N({},g),{},k({},F,r));L((function(){return r})),j((function(){return o})),c.option.updateLayerOption(S(o),"vehicle"),localStorage.setItem("layerMenuParams",JSON.stringify(o)),n&&"pointCloud"===e&&!d(e)&&u&&m({name:h.DU.POINT_CLOUD,needChannel:!0,channel:u}),n||"pointCloud"!==e||p(h.DU.POINT_CLOUD)}})),r.createElement("span",{className:a["layer-menu-content-right-label"]},s(e)))})))))}const M=r.memo(F);var T=n(79424),V=n(51999),L=n(2629),z=n(39111),D=n(44606);function _(e){return _="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_(e)}function K(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function U(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?K(Object(n),!0).forEach((function(t){var r,o,i;r=e,o=t,i=n[t],(o=function(e){var t=function(e,t){if("object"!==_(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==_(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===_(t)?t:String(t)}(o))in r?Object.defineProperty(r,o,{value:i,enumerable:!0,configurable:!0,writable:!0}):r[o]=i})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):K(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function W(){return(0,D.BH)((function(e){return{"routing-editing-op-area":U({width:192,height:32,color:"#A6B5CC",borderRadius:6,position:"absolute",top:24,left:24},e.util.flex("row","space-between","center")),"routing-editing-btn":U(U({width:144,height:32,borderRadius:6,background:"#343C4D"},e.util.flexCenterCenter),{},{"&:hover":{cursor:"pointer",background:"#38465A",color:"#fff"}}),"routing-editing-btn__icon":{marginRight:6},"routing-editing-btn__text":{fontFamily:"PingFangSC-Regular",fontSize:14},"common-routing-editing-btn":U(U({width:32,minWidth:32,height:32,minHeight:32,background:"#343C4D",borderRadius:6},e.util.flexCenterCenter),{},{"&:hover":{cursor:"pointer",background:"#38465A",color:"#fff"}}),"common-routing-editing-btn__icon":{},"routing-editing-disable":{cursor:"not-allowed","& .routing-editing-btn-disable":{color:"#515761",pointerEvents:"none",background:"#383D47"},"& .common-routing-editing-btn-disbale":{color:"#515761",pointerEvents:"none",background:"#383D47"}},"routing-editing-btn-popover":{"& .dreamview-popover-inner-content":{padding:"5px 10px",fontFamily:"PingFangSC-Regular",fontSize:"14px",fontWeight:"400",borderRadius:"6px"},"& .dreamview-popover-arrow::after":{}},"common-routing-popover-ordinary":{"& .dreamview-popover-inner, & .dreamview-popover-arrow::after":{background:"rgba(80, 88, 102, 0.8) !important"},"& .dreamview-popover-arrow::after":{background:"rgba(80, 88, 102, 0.8) !important"}},"common-routing-popover-functional":{"& .dreamview-popover-inner,& .dreamview-popover-arrow::before, & .dreamview-popover-arrow::after":{color:"#A6B5CC !important",background:"rgba(40, 43, 54) !important"},"& .dreamview-popover-arrow::before":{background:"rgba(40, 43, 54) !important"},"& .dreamview-popover-arrow::after":{background:"rgba(40, 43, 54) !important"}}}}))()}var B=(0,r.forwardRef)((function(e,t){var n=e.onClick,o=W(),a=o.classes,l=o.cx,c=(0,w.$G)("routeEditing").t;return r.createElement("div",{id:"routing-editing-btn",className:l(a["routing-editing-btn"],"routing-editing-btn-disable"),onClick:n,ref:t},r.createElement("i",{className:a["routing-editing-btn__icon"]},r.createElement(i.xI,null)),r.createElement("div",{className:a["routing-editing-btn__text"]},c("routingEditing")))})),G=(0,r.forwardRef)((function(e,t){var n=e.onClick,o=W(),a=o.classes,l=o.cx;return r.createElement("div",{className:l(a["common-routing-editing-btn"],"common-routing-editing-btn-disbale"),onClick:n,ref:t},r.createElement("i",{className:a["common-routing-editing-btn__icon"]},r.createElement(i.xG,null)))}));B.displayName="RoutingEditingBtn",G.displayName="CommonRoutingEditingBtn";var $=n(26658),H=n(6837),Z=n(61534),J=n(86944),Y=n(64698);function q(e){return q="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},q(e)}function X(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Q(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?X(Object(n),!0).forEach((function(t){var r,o,i;r=e,o=t,i=n[t],(o=function(e){var t=function(e,t){if("object"!==q(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==q(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===q(t)?t:String(t)}(o))in r?Object.defineProperty(r,o,{value:i,enumerable:!0,configurable:!0,writable:!0}):r[o]=i})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):X(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function ee(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i,a,l=[],c=!0,u=!1;try{if(i=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=i.call(n)).done)&&(l.push(r.value),l.length!==t);c=!0);}catch(e){u=!0,o=e}finally{try{if(!c&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}(e,t)||te(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function te(e,t){if(e){if("string"==typeof e)return ne(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?ne(e,t):void 0}}function ne(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function re(e){var t,n=e.EE,o=e.destroy,a=e.mainApi,l=e.panelContext,c=e.routeManager,u=e.routingEditor,s=e.isMainConnected,f=e.defaultRoutingList,m=e.createCommonRoutingSuccessFunctional,p=ee(i.l0.useForm(),1)[0],y=(0,D.BH)((function(e){return{"routing-modal":{"& .dreamview-modal-wrap":{zIndex:"1040"},"& .dreamview-modal-mask":{zIndex:"1040"},"& .dreamview-modal-content":{width:"492px","& .dreamview-modal-body":{marginTop:"30px",label:{color:"#FFFFFF",fontFamily:"PingFangSC-Regular",fontWeight:"400"},"& .dreamview-form":{"& .ant-form-item":{marginBottom:"16px"},"& > div:nth-of-type(1)":{"& .ant-form-item-label":{"& label":{position:"relative",top:"4px"}}}}}},"& .dreamview-modal-footer":{display:"flex",justifyContent:"center",alignItems:"center","& > button":{width:"74px",height:"40px",borderRadius:"8px"},"& > button:nth-of-type(1)":{color:"#FFFFFF",background:"#282B36",border:"1px solid rgba(124,136,153,1)"},"& > button:nth-of-type(2)":{background:"#3288FA",borderRadius:"8px",marginLeft:"24px !important"}}},"routing-form-initial":{fontFamily:"PingFangSC-Regular",fontSize:"14px",fontWeight:"400",color:"#FFFFFF",marginLeft:"39px",marginBottom:"16px",display:"flex"},"routing-form-initial-content":{width:"320px",color:"#FFFFFF",display:"flex",justifyContent:"space-between"},"routing-form-initial-content-heading":{width:"111px"},"routing-form-way":{height:"264px",border:"1px solid rgba(56,59,69,1)",borderRadius:"8px",padding:"16px 0px 16px 45px",marginBottom:"12px"},"routing-form-way-con":{fontFamily:"PingFangSC-Regular",fontSize:"14px",fontWeight:"400",color:"#FFFFFF",display:"flex"},"routing-form-way-content":{flex:"1"},"routing-form-way-item":{color:"#FFFFFF",marginBottom:"8px",display:"flex",justifyContent:"space-between"},"routing-form-way-item-heading":{width:"111px"},"routing-form-colon":{color:"#A6B5CC",marginRight:"6px"},"routing-form-colon-distance":{marginLeft:"2px"},"routing-form-loop-disable":{background:"rgb(40, 93, 164)","& .dreamview-switch-handle":{background:"rgb(190, 206, 227)",borderRadius:"3px"}},"create-modal-form":{"& .ant-form-item-label":{"& label":{color:"#A6B5CC !important"}}}}}))(),d=(y.cx,y.classes),v=(0,w.$G)("routeEditing").t,b=c.currentRouteMix,g=b.getCurrentRouteMix().currentRouteLoop.currentRouteLoopState,E=null===(t=b.getCurrentRouteMix().currentRouteLoop)||void 0===t?void 0:t.currentRouteLoopTimes,O=ee((0,r.useState)([]),2),S=O[0],x=O[1],P=ee((0,r.useState)({x:0,y:0}),2),C=P[0],j=P[1];return(0,r.useEffect)((function(){var e=u.initiationMarker.initiationMarkerPosition,t=u.pathwayMarker.pathWatMarkerPosition;e?j(e):a.getStartPoint().then((function(e){j({x:e.x,y:e.y,heading:null==e?void 0:e.heading})})),x(t)}),[s]),r.createElement(i.u_,{title:v("routeCreateCommonBtn"),okText:v("create"),cancelText:v("cancel"),open:!0,onOk:function(){p.validateFields().then((function(){if(s&&a){var e=p.getFieldsValue();if(e.loopRouting){var t=Number(e.cycleNumber);e.cycleNumber=t>10?10:t}delete e.loopRouting,a.saveDefaultRouting(Q(Q({},e),{},{routingType:h.Sw.DEFAULT_ROUTING,point:[C].concat((r=S,function(e){if(Array.isArray(e))return ne(e)}(r)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(r)||te(r)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()))})).then((function(){n.emit(Y.l.SimControlRoute,{panelId:l.panelId,routeInfo:{initialPoint:C,wayPoint:S,cycleNumber:null==e?void 0:e.cycleNumber}}),m(),o(),(0,i.yw)({type:"success",content:v("createCommonRouteSuccess")})}))}var r}))},onCancel:function(){o()},rootClassName:d["routing-modal"]},r.createElement(i.l0,{form:p,name:"form",className:d["create-modal-form"],initialValues:{loopRouting:g,cycleNumber:E}},r.createElement(i.l0.Item,{label:v("name"),style:{marginLeft:"74px"},name:"name",rules:[function(e){return e.getFieldValue,{validator:function(e,t){return t?t&&f.find((function(e){return e.name===t}))?Promise.reject(new Error(v("alreadyExists"))):Promise.resolve():Promise.reject(new Error(v("pleaseEnter")))}}}]},r.createElement(i.II,{placeholder:"Please enter",style:{width:"252px",height:"40px"}})),r.createElement("div",{className:d["routing-form-initial"]},r.createElement("div",{className:d["routing-form-colon"]},v("initialPoint"),r.createElement("span",{className:d["routing-form-colon-distance"]},":")),r.createElement("div",{className:d["routing-form-initial-content"]},r.createElement("div",null,"[".concat(C.x.toFixed(3)," ，").concat(C.y.toFixed(3),"]")),r.createElement("div",{className:d["routing-form-initial-content-heading"]},null!=C&&C.heading?C.heading.toFixed(3):"-"))),r.createElement(J.Z,{className:d["routing-form-way"]},r.createElement("div",{className:d["routing-form-way-con"]},r.createElement("div",{className:d["routing-form-colon"]},v("wayPoint"),r.createElement("span",{className:d["routing-form-colon-distance"]},":")),r.createElement("div",{className:d["routing-form-way-content"]},null==S?void 0:S.map((function(e,t){return r.createElement("div",{key:"".concat(e.x).concat(e.y).concat(t+1),className:d["routing-form-way-item"]},r.createElement("div",null,"[".concat(e.x.toFixed(3),"，").concat(e.y.toFixed(3),"]")),r.createElement("div",{className:d["routing-form-way-item-heading"]},null!=e&&e.heading?e.heading.toFixed(3):"-"))}))))),g&&r.createElement(i.l0.Item,{label:v("loopRouting"),style:{marginLeft:"16px"},name:"loopRouting",valuePropName:"checked"},r.createElement(i.rs,{disabled:!0,className:d["routing-form-loop-disable"]})),g&&r.createElement(i.l0.Item,{label:v("setLooptimes"),style:{marginLeft:"11px"},name:"cycleNumber",rules:[function(e){return e.getFieldValue,{validator:function(e,t){return t?Number(t)>10?Promise.reject(new Error("Max loop times is 10")):Promise.resolve():Promise.reject(new Error("Please enter"))}}}]},r.createElement(i.Rn,{type:"number",max:10,precision:0,disabled:!0}))))}var oe=function(e){return e.EDITING_ROUTE="editing",e.CREATING_ROUTE="creating",e}({}),ie=function(e){return e.INITIAL_POINT="initial_point",e.WAY_POINT="way_point",e}({}),ae=n(53457),le=n(7501),ce="INIT_ROUTING_EDITOR",ue="INIT_ROUTE_MANAGER",se=ae.Fk.createStoreProvider({initialState:{routingEditor:null,routeManager:null},reducer:function(e,t){return(0,le.Uy)(e,(function(e){switch(t.type){case ce:e.routingEditor=t.payload.routingEditor;break;case ue:e.routeManager=t.payload.routeManager}}))}}),fe=se.StoreProvider,me=se.useStore,pe=n(63483),ye=n(32870);function de(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i,a,l=[],c=!0,u=!1;try{if(i=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=i.call(n)).done)&&(l.push(r.value),l.length!==t);c=!0);}catch(e){u=!0,o=e}finally{try{if(!c&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}(e,t)||ve(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ve(e,t){if(e){if("string"==typeof e)return be(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?be(e,t):void 0}}function be(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function ge(e){var t=e.activeOrigin,n=e.destroyFunFavoriteNotFullScreen,o=(0,D.BH)((function(e){return{"favorite-scroll":{width:"284px",maxHeight:"402px",padding:"16px 16px"},"favorite-creating-op":{width:"252px",height:"40px",marginBottom:"10px"},"favorite-common-co":{"& > div:last-child":{borderBottom:"none"}},"favorite-common-item":{height:"40px",color:"#A6B5CC",fontSize:"14px",fontWeight:"400",fontFamily:"PingFangSC-Regular",borderBottom:"1px solid #383B45",cursor:"pointer",display:"flex",justifyContent:"space-between",alignItems:"center","& .favorite-common-item-op-hover":{display:"none"},"&:hover":{width:"268px",background:"rgba(115,193,250,0.08)",borderRadius:"6px",margin:"0px -8px 0px -8px",padding:"0px 8px 0px 8px","& .favorite-common-item-op-no-hover":{display:"none"},"& .favorite-common-item-op-hover":{display:"block"}}},"favorite-common-item-active":{background:"#3288FA !important",borderRadius:"6px",margin:"0px -8px 0px -8px",padding:"0px 8px 0px 8px","& .favorite-common-item-name-cx":{color:"#FFFFFF"},"& .favorite-common-item-op-no-hover-val-cx":{background:"#3288FA"},"& .favorite-common-item-op-no-hover-title-cx":{color:"#FFFFFF !important"},"&: hover":{"& .favorite-common-item-op-hover":{display:"none"},"& .favorite-common-item-op-no-hover":{display:"block"}}},"favorite-common-item-op-no-hover-title":{color:"#808B9D"},"favorite-common-item-op-no-hover-val":{width:"18px",height:"18px",color:"#FFFFFF",fontSize:"12px",textAlign:"center",lineHeight:"18px",marginLeft:"4px",background:"#343C4D",borderRadius:"4px",display:"inline-block"},"favorite-common-item-op-hover-remove":{color:"#FFFFFF",marginLeft:"23px"},"favorite-common-item-name":{width:"150px",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},"favorite-warning-co":{padding:"14px 0px 32px 0px",display:"flex",flexDirection:"column",alignItems:"center"},"favorite-warning-co-desc":{width:"195px",color:"#A6B5CC",fontSize:"12px",fontWeight:"400",fontFamily:"PingFangSC-Regular"},"favorite-warning-co-desc-active":{color:"#3288FA",cursor:"pointer"}}}))(),a=o.cx,l=o.classes,c=(0,ye.x2)(),u=v(),s=(0,P.R)(),f=s.enterFullScreen,m=(0,w.$G)("routeEditing").t,p=de(me(),1)[0],y=p.routeManager,d=p.routingEditor,b=y.currentRouteManager,g=(0,C.Z)(),h=g.mainApi,E=g.isMainConnected,O=de((0,r.useState)(null),2),S=O[0],x=O[1],j=de((0,r.useState)([]),2),R=j[0],N=j[1],k=function(){E&&h.getDefaultRoutings().then((function(e){N(e.defaultRoutings.reverse())}))},I=(0,r.useCallback)((function(){t===pe.yP.FROM_FULLSCREEN&&(d.pathwayMarker.positionsCount&&E?(0,Z.Z)({EE:c,mainApi:h,routeManager:y,routingEditor:d,panelContext:s,isMainConnected:E,defaultRoutingList:R,createCommonRoutingSuccessFunctional:k},re):(0,i.yw)({type:"error",content:m("NoWayPointMessage")})),t===pe.yP.FROM_NOT_FULLSCREEN&&(n(),u("/routing"),f())}),[c,h,R,y,d,s,t,y,E,u,f]);return(0,r.useEffect)((function(){E&&h.getDefaultRoutings().then((function(e){N(e.defaultRoutings.reverse())}))}),[E]),(0,r.useEffect)((function(){var e,t,n,r,o,i;x((e=R,t=b.getCurrentRoute(),o=[null==t||null===(n=t.routePoint)||void 0===n?void 0:n.routeInitialPoint].concat(function(e){if(Array.isArray(e))return be(e)}(i=(null==t||null===(r=t.routePoint)||void 0===r?void 0:r.routeWayPoint)||[])||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(i)||ve(i)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),e.find((function(e){return e.point.length===o.length&&e.point.every((function(e,t){var n,r,i;return(null==e?void 0:e.heading)===(null===(n=o[t])||void 0===n?void 0:n.heading)&&e.x===(null===(r=o[t])||void 0===r?void 0:r.x)&&e.y===(null===(i=o[t])||void 0===i?void 0:i.y)}))}))))}),[R]),(0,r.useEffect)((function(){t!==pe.yP.FROM_NOT_FULLSCREEN&&E&&h.getStartPoint().then((function(e){var t={x:e.x,y:e.y,heading:null==e?void 0:e.heading},n=d.pathwayMarker.lastPosition;h.checkCycleRouting({start:t,end:n}).then((function(e){e.isCycle||y.currentRouteMix.setCurrentRouteMix({currentRouteLoop:{currentRouteLoopState:!1}})}))}))}),[E,t]),r.createElement(J.Z,{className:l["favorite-scroll"]},t!==pe.yP.FROM_NOT_FULLSCREEN&&r.createElement(i.zx,{className:l["favorite-creating-op"],onClick:I},m("routeCreateCommonBtn")),R.length?r.createElement("div",{className:l["favorite-common-co"]},R.map((function(e){return r.createElement("div",{key:e.name,onClick:function(){return function(e){x(e);var t=s.panelId,n=e.point[0],r=e.point.slice(1),o=null==e?void 0:e.cycleNumber,i={initialPoint:n,wayPoint:r,cycleNumber:o};y.currentRouteMix.setCurrentRouteMix({currentRouteLoop:{currentRouteLoopState:!!o,currentRouteLoopTimes:o}}),h.setStartPoint({point:n}).then((function(){b.setCurrentRoute({routeOrigin:oe.CREATING_ROUTE,routePoint:{routeInitialPoint:n,routeWayPoint:r}}),c.emit(Y.l.SimControlRoute,{panelId:t,routeInfo:i})}))}(e)},className:a(l["favorite-common-item"],S&&S.name===e.name&&l["favorite-common-item-active"])},r.createElement("div",{className:a("favorite-common-item-name-cx",l["favorite-common-item-name"]),title:e.name},e.name),e.cycleNumber&&r.createElement("div",{className:a("favorite-common-item-op-no-hover")},r.createElement("span",{className:a("favorite-common-item-op-no-hover-title-cx",l["favorite-common-item-op-no-hover-title"])},m("looptimes")),r.createElement("span",{className:a("favorite-common-item-op-no-hover-val-cx",l["favorite-common-item-op-no-hover-val"])},e.cycleNumber)),r.createElement("div",{className:a("favorite-common-item-op-hover")},r.createElement("span",{onClick:(t=e.name,function(e){e.stopPropagation(),E&&h.deleteDefaultRouting(t).then((function(){h.getDefaultRoutings().then((function(e){N(e.defaultRoutings.reverse())}))}))}),className:a("favorite-common-item-op-hover-remove-cx",l["favorite-common-item-op-hover-remove"])},r.createElement(H.Z,null))));var t}))):r.createElement("div",{className:l["favorite-warning-co"]},r.createElement("img",{src:$,alt:"resource_empty"}),r.createElement("div",{className:l["favorite-warning-co-desc"]},"".concat(m("createRouteToolTip"),","),r.createElement("span",{className:l["favorite-warning-co-desc-active"],onClick:I},m("goToCreate")))))}const he=r.memo(ge);function Ee(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i,a,l=[],c=!0,u=!1;try{if(i=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=i.call(n)).done)&&(l.push(r.value),l.length!==t);c=!0);}catch(e){u=!0,o=e}finally{try{if(!c&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}(e,t)||function(e,t){if(e){if("string"==typeof e)return we(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?we(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function we(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Oe(){var e=W(),t=e.classes,n=e.cx,o=v(),a=Ee((0,g.Mq)(),1)[0],l=(0,P.R)().enterFullScreen,c=(0,w.$G)("routeEditing").t,u={popoverDisableText:c("routeEditingBtnOther")},s=Ee((0,r.useState)(!1),2),f=s[0],m=s[1],p=Ee((0,r.useState)(!1),2),y=p[0],d=p[1],b=Ee((0,r.useState)(!(a.currentMap&&a.currentVehicle)),2),h=b[0],E=b[1],O=r.createElement(he,{activeOrigin:pe.yP.FROM_NOT_FULLSCREEN,destroyFunFavoriteNotFullScreen:function(){d(!1)}}),S=(0,r.useCallback)((function(){l(),setTimeout((function(){o("/routing")}))}),[l,o]);return(0,r.useEffect)((function(){a.currentOperation===g.yc.SCENARIO||a.currentOperation===g.yc.SIM_CONTROL?E(!1):E(!0)}),[a]),r.createElement("div",{className:n(h&&t["routing-editing-disable"],t["routing-editing-op-area"])},h?r.createElement(r.Fragment,null,r.createElement(i.J2,{content:null==u?void 0:u.popoverDisableText,trigger:"hover",placement:"top",rootClassName:t["routing-editing-btn-popover"]},r.createElement(r.Fragment,null,r.createElement(B,{onClick:S}))),r.createElement(i.J2,{content:null==u?void 0:u.popoverDisableText,trigger:"hover",placement:"top",rootClassName:t["routing-editing-btn-popover"]},r.createElement(r.Fragment,null,r.createElement(G,null)))):r.createElement(r.Fragment,null,r.createElement(B,{onClick:S}),r.createElement(i.J2,{content:c("routeCreateCommonBtn"),trigger:"hover",placement:"top",open:f,onOpenChange:function(e){m(e),d(!1)},rootClassName:t["routing-editing-btn-popover"]},r.createElement(i.J2,{content:O,trigger:"click",placement:"rightTop",open:y,onOpenChange:function(e){m(!1),d(e)},destroyTooltipOnHide:!0},r.createElement(r.Fragment,null,r.createElement(G,null))))))}var Se=n(84663),xe=n(24545),Pe=function(e){return e.DEFAULT="Default",e.OVERHEAD="Overhead",e.MAP="Map",e.NEAR="Near",e.TOP_DOWN="TopDown",e}({});function Ce(e){return Ce="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ce(e)}function je(){return je=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},je.apply(this,arguments)}function Re(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Ne(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Re(Object(n),!0).forEach((function(t){var r,o,i;r=e,o=t,i=n[t],(o=function(e){var t=function(e,t){if("object"!==Ce(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==Ce(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===Ce(t)?t:String(t)}(o))in r?Object.defineProperty(r,o,{value:i,enumerable:!0,configurable:!0,writable:!0}):r[o]=i})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Re(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function ke(e){var t=(0,D.BH)((function(e){return{"custom-popover":{"&.dreamview-popover .dreamview-popover-inner":{padding:0},"& .dreamview-popover-inner, & .dreamview-popover-arrow::after":{background:"rgba(80, 88, 102, 0.8)"},"& .dreamview-popover-arrow::after":{background:"rgba(80, 88, 102, 0.8)"},"& .dreamview-popover-content .dreamview-popover-inner .dreamview-popover-inner-content":Ne({},e.tokens.typography.content)}}}))(),n=t.classes;return t.cx,r.createElement(i.J2,je({},e,{rootClassName:"".concat(n["custom-popover"]," ").concat(e.rootClassName||"")}))}const Ie=r.memo(ke);function Ae(e){return Ae="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ae(e)}function Fe(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Me(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Fe(Object(n),!0).forEach((function(t){var r,o,i;r=e,o=t,i=n[t],(o=function(e){var t=function(e,t){if("object"!==Ae(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==Ae(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===Ae(t)?t:String(t)}(o))in r?Object.defineProperty(r,o,{value:i,enumerable:!0,configurable:!0,writable:!0}):r[o]=i})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Fe(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Te(){return(0,D.BH)((function(e){return{"routing-editing-function-area":Me({width:32,position:"absolute",top:25,left:24},e.util.flex("column","space-around","center")),"routing-editing-function-area__group":{background:"#343C4D",borderRadius:6,marginBottom:10},"routing-editing-functional__item":Me(Me({width:32,minWidth:32,height:32,minHeight:32,background:"#343C4D",borderRadius:6},e.util.flexCenterCenter),{},{"&:hover":{cursor:"pointer",background:"#38465A"}}),"hover-color-change":{"&:hover":{color:"#fff"}},"routing-editing-functional__item--active":{color:"#3388FA"},"routing-editing-functional__icon":{},"custom-popover-ordinary":{"& .dreamview-popover-inner, & .dreamview-popover-arrow::after":{background:"rgba(80, 88, 102, 0.8) !important"},"& .dreamview-popover-arrow::after":{background:"rgba(80, 88, 102, 0.8) !important"}},"custom-popover-functinal":{"& .dreamview-popover-inner,& .dreamview-popover-arrow::before, & .dreamview-popover-arrow::after":{color:"#A6B5CC !important",background:"rgba(40, 43, 54) !important"},"& .dreamview-popover-arrow::before":{background:"rgba(40, 43, 54) !important"},"& .dreamview-popover-arrow::after":{background:"rgba(40, 43, 54) !important"}}}}))()}function Ve(e){return Ve="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ve(e)}function Le(e,t,n){return(t=function(e){var t=function(e,t){if("object"!==Ve(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==Ve(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===Ve(t)?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function ze(e,t){var n,o=e.functionalName,a=e.checkedItem,l=e.onClick,c=(0,r.useMemo)((function(){return a===o}),[o,a]),u=Te(),s=u.classes,f=u.cx,m=(0,r.useMemo)((function(){switch(o){case pe.Iz.RELOCATE:return r.createElement("i",null,r.createElement(i.Xf,null));case pe.Iz.WAYPOINT:return r.createElement("i",null,r.createElement(i.vC,null));case pe.Iz.LOOP:return r.createElement("i",null,r.createElement(i.Fc,null));case pe.Iz.FAVORITE:return r.createElement("i",null,r.createElement(i.xG,null));default:return null}}),[o]);return r.createElement("div",{ref:t,className:f(s["routing-editing-functional__item"],(n={},Le(n,s["routing-editing-functional__item--active"],c),Le(n,s["hover-color-change"],!c),n)),onClick:l},r.createElement("div",{className:s["routing-editing-functional__icon"]},m))}const De=(0,r.forwardRef)(ze);var _e=function(e){return e.FunctionalRelocateNoActive="initialPoint",e.FunctionaWayNoActive="wayPoint",e.FunctionalLoopNoActive="loopRouting",e.FunctionalFavoriteNoActive="commonRouting",e}({});function Ke(e){var t=e.functionalItemNoActiveText,n=(0,D.BH)((function(e){return{"routing-editing-item-no-active":{padding:"5px 10px",color:"#FFFFFF",fontSize:"14px",fontWeight:"400",fontFamily:"PingFangSC-Regular"}}}))(),o=n.classes,i=(n.cx,(0,w.$G)("routeEditing").t);return r.createElement("div",{className:o["routing-editing-item-no-active"]},i(t))}function Ue(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i,a,l=[],c=!0,u=!1;try{if(i=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=i.call(n)).done)&&(l.push(r.value),l.length!==t);c=!0);}catch(e){u=!0,o=e}finally{try{if(!c&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}(e,t)||function(e,t){if(e){if("string"==typeof e)return We(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?We(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function We(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Be(e){var t=(0,D.BH)((function(e){return{"functional-initial-con":{display:"flex"},"functional-initial-every-icon-con":{cursor:"not-allowed"},"functional-initial-disable":{"& .functional-initial-every-icon-disable":{color:"#40454D",pointerEvents:"none"}},"functional-initial-popover":{"& .dreamview-popover-inner-content":{padding:"5px 10px",color:"#FFFFFF",fontFamily:"PingFangSC-Regular",fontSize:"14px",fontWeight:"400"}},"functional-initial-every-icon":{width:"32px",height:"32px",color:"#A6B5CC",display:"flex",justifyContent:"center",alignItems:"center","&:hover":{color:"#D8D8D8",background:"rgba(115,193,250,0.08)"}}}}))(),n=t.classes,o=t.cx,a=Ue(me(),1)[0].routingEditor,l=(0,w.$G)("routeEditing").t,c=(0,C.Z)(),u=c.isMainConnected,s=c.mainApi,f=Ue((0,r.useState)(a.initiationMarker.positionsCount),2),m=f[0],p=f[1],y=Ue((0,r.useState)(!(m>0)),2),d=y[0],v=y[1];return(0,r.useEffect)((function(){v(!m)}),[m]),r.createElement("div",{className:o(d&&n["functional-initial-disable"],n["functional-initial-con"])},r.createElement(i.J2,{content:l("backToLastPoint"),trigger:"hover",rootClassName:n["functional-initial-popover"]},r.createElement("div",{className:d&&o(n["functional-initial-every-icon-con"])},r.createElement("div",{className:o("functional-initial-every-icon-disable",n["functional-initial-every-icon"]),onClick:function(){var e=a.initiationMarker.undo();u&&(e?s.setStartPoint({point:e}).then((function(){p(a.initiationMarker.positionsCount)})):s.setResetPoint().then((function(){p(a.initiationMarker.positionsCount)})))}},r.createElement(i.jd,null)))),r.createElement(i.J2,{content:l("backToStartPoint"),trigger:"hover",rootClassName:n["functional-initial-popover"]},r.createElement("div",{className:d&&o(n["functional-initial-every-icon-con"])},r.createElement("div",{className:o("functional-initial-every-icon-disable",n["functional-initial-every-icon"]),onClick:function(){u&&s.setResetPoint().then((function(){a.initiationMarker.reset(),p(a.initiationMarker.positionsCount)}))}},r.createElement(i.Nq,null)))))}function Ge(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i,a,l=[],c=!0,u=!1;try{if(i=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=i.call(n)).done)&&(l.push(r.value),l.length!==t);c=!0);}catch(e){u=!0,o=e}finally{try{if(!c&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}(e,t)||function(e,t){if(e){if("string"==typeof e)return $e(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?$e(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function $e(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function He(e){var t=(0,D.BH)((function(e){return{"functional-initial-con":{display:"flex"},"functional-initial-every-icon-con":{cursor:"not-allowed"},"functional-initial-disable":{"& .functional-initial-every-icon-disable":{color:"#40454D",pointerEvents:"none"}},"functional-initial-popover":{"& .dreamview-popover-inner-content":{padding:"5px 10px",color:"#FFFFFF",fontFamily:"PingFangSC-Regular",fontSize:"14px",fontWeight:"400"}},"functional-initial-every-icon":{width:"32px",height:"32px",color:"#A6B5CC",display:"flex",justifyContent:"center",alignItems:"center","&:hover":{color:"#D8D8D8",background:"rgba(115,193,250,0.08)"}}}}))(),n=t.classes,o=t.cx,a=Ge(me(),1)[0].routingEditor,l=(0,w.$G)("routeEditing").t,c=Ge((0,r.useState)(a.pathwayMarker.positionsCount),2),u=c[0],s=c[1],f=Ge((0,r.useState)(!(u>0)),2),m=f[0],p=f[1];return(0,r.useEffect)((function(){p(!u)}),[u]),r.createElement("div",{className:o(m&&n["functional-initial-disable"],n["functional-initial-con"])},r.createElement(i.J2,{content:l("removeLastPoint"),trigger:"hover",rootClassName:n["functional-initial-popover"]},r.createElement("div",{className:m&&o(n["functional-initial-every-icon-con"])},r.createElement("div",{className:o("functional-initial-every-icon-disable",n["functional-initial-every-icon"]),onClick:function(){a.pathwayMarker.undo(),s(a.pathwayMarker.positionsCount)}},r.createElement(i.jd,null)))),r.createElement(i.J2,{content:l("removeAllPoints"),trigger:"hover",rootClassName:n["functional-initial-popover"]},r.createElement("div",{className:m&&o(n["functional-initial-every-icon-con"])},r.createElement("div",{className:o("functional-initial-every-icon-disable",n["functional-initial-every-icon"]),onClick:function(){a.pathwayMarker.reset(),s(a.pathwayMarker.positionsCount)}},r.createElement(i.hO,null)))))}function Ze(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i,a,l=[],c=!0,u=!1;try{if(i=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=i.call(n)).done)&&(l.push(r.value),l.length!==t);c=!0);}catch(e){u=!0,o=e}finally{try{if(!c&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}(e,t)||function(e,t){if(e){if("string"==typeof e)return Je(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Je(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Je(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Ye(e){var t=(0,D.BH)((function(e){return{"functional-loop-con":{width:"257px",padding:"16px 0px 21px 0px",color:"#A6B5CC",fontSize:"14px",fontWeight:"400",fontFamily:"PingFangSC-Regular"},"functional-loop-switch":{width:"160px",height:"20px",margin:"0px 0px 0px 32px",display:"flex",justifyContent:"space-around",alignItems:"center"},"functional-loop-switch-help":{"& .dreamview-popover-arrow::before":{background:"rgba(40, 43, 54) !important"},"& .dreamview-popover-arrow::after":{background:"rgba(40, 43, 54) !important"},"& .dreamview-popover-inner-content":{width:"302px",color:"#FFFFFF",fontSize:"14px",fontWeight:"400",padding:"5px 10px",borderRadius:"6px",fontFamily:"PingFangSC-Regular",background:"rgba(80, 88, 102, 0.8)"}},"functional-loop-switch-remind":{position:"relative",top:"2px"},"functional-loop-input":{height:"32px",margin:"16px 0px 0px 20px",display:"flex",alignItems:"center"},"functional-loop-input-text":{marginRight:"6px"}}}))(),n=t.classes,o=(t.cx,Ze(me(),1)[0].routeManager),a=(0,w.$G)("routeEditing").t,l=o.currentRouteMix,c=l.getCurrentRouteMix(),u=Ze((0,r.useState)(c.currentRouteLoop.currentRouteLoopState),2),s=u[0],f=u[1];return r.createElement("div",{className:n["functional-loop-con"]},r.createElement("div",{className:n["functional-loop-switch"]},r.createElement("div",null,"".concat(a("loopRouting"),":")),r.createElement("div",null,r.createElement(i.rs,{onChange:function(e){e?l.setCurrentRouteMix({currentRouteLoop:{currentRouteLoopState:!0,currentRouteLoopTimes:1}}):l.setCurrentRouteMix({currentRouteLoop:{currentRouteLoopState:!1}}),f(e)},checked:s})),r.createElement(i.J2,{content:a("loopRoutingHelp"),trigger:"hover",placement:"top",rootClassName:n["functional-loop-switch-help"]},r.createElement("div",{className:n["functional-loop-switch-remind"]},r.createElement(i.Ki,null)))),s&&r.createElement("div",{className:n["functional-loop-input"]},r.createElement("div",{className:n["functional-loop-input-text"]},"".concat(a("setLooptimes"),":")),r.createElement("div",null,r.createElement(i.Rn,{min:1,max:10,precision:0,onChange:function(e){l.setCurrentRouteMix({currentRouteLoop:{currentRouteLoopState:!0,currentRouteLoopTimes:e}})},defaultValue:l.getCurrentRouteMix().currentRouteLoop.currentRouteLoopTimes}))))}function qe(e){return qe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},qe(e)}function Xe(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Qe(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Xe(Object(n),!0).forEach((function(t){var r,o,i;r=e,o=t,i=n[t],(o=function(e){var t=function(e,t){if("object"!==qe(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==qe(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===qe(t)?t:String(t)}(o))in r?Object.defineProperty(r,o,{value:i,enumerable:!0,configurable:!0,writable:!0}):r[o]=i})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Xe(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function et(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i,a,l=[],c=!0,u=!1;try{if(i=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=i.call(n)).done)&&(l.push(r.value),l.length!==t);c=!0);}catch(e){u=!0,o=e}finally{try{if(!c&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}(e,t)||function(e,t){if(e){if("string"==typeof e)return tt(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?tt(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function tt(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function nt(e){var t=e.carviz,n=e.changeActiveName,o=e.activeName,a=et(me(),1)[0],l=a.routeManager,c=a.routingEditor,u=(0,C.Z)(),s=u.isMainConnected,f=u.mainApi,m=Te(),p=m.classes,y=m.cx,d=(0,w.$G)("routeEditing").t,v=l.currentRouteMix,b=et((0,r.useState)(null),2),g=b[0],h=b[1],E=(0,r.useCallback)((function(e,n){var r={routeOrigin:oe.EDITING_ROUTE,routePoint:{routeInitialPoint:t.initiationMarker.initiationMarkerPosition,routeWayPoint:t.pathwayMarker.pathWatMarkerPosition}};if(n)if("lastPosition"in n){var o,i,a=n.lastPosition;"edit"===e&&(null===(i=l.currentRouteManager)||void 0===i||i.setScribeCurrentCheckPoint(Qe(Qe({},a),{},{type:ie.WAY_POINT}))),null===(o=l.currentRouteManager)||void 0===o||o.setCurrentRoute(r)}else{var c,u;"edit"===e&&(null===(u=l.currentRouteManager)||void 0===u||u.setScribeCurrentCheckPoint(Qe(Qe({},n),{},{type:ie.INITIAL_POINT}))),null===(c=l.currentRouteManager)||void 0===c||c.setCurrentRoute(r)}}),[t.initiationMarker,t.pathwayMarker,l.currentRouteManager]);(0,r.useEffect)((function(){Object.values(pe.c3).includes(o)&&([pe.c3.RELOCATE,pe.c3.WAYPOINT].includes(o)||h(null))}),[o,t]),(0,r.useEffect)((function(){var e=function(e){"r"===e.key&&g!==pe.Iz.RELOCATE&&(null==t||t.deactiveAll(),h(pe.Iz.RELOCATE),null==n||n(pe.c3.RELOCATE),null==t||t.initiationMarker.active(E)),"w"===e.key&&g!==pe.Iz.WAYPOINT&&(null==t||t.deactiveAll(),h(pe.Iz.WAYPOINT),null==n||n(pe.c3.WAYPOINT),null==t||t.pathwayMarker.active(E)),(e.ctrlKey||e.metaKey)&&"z"===e.key&&(g===pe.Iz.RELOCATE&&(null==t||t.initiationMarker.undo()),g===pe.Iz.WAYPOINT&&(null==t||t.pathwayMarker.undo()))};return window.addEventListener("keydown",e),function(){window.removeEventListener("keydown",e)}}),[g]);var O=(0,r.useCallback)((function(e){return function(){if(g===e)return Object.values(pe.c3).includes(e)&&(null==t||t.deactiveAll()),void h(null);switch(e){case pe.Iz.RELOCATE:h(e),null==t||t.deactiveAll(),null==n||n(pe.c3.RELOCATE),null==t||t.initiationMarker.active(E);break;case pe.Iz.WAYPOINT:h(e),null==t||t.deactiveAll(),null==n||n(pe.c3.WAYPOINT),null==t||t.pathwayMarker.active(E);break;case pe.Iz.LOOP:c.pathwayMarker.positionsCount>0?s&&f.getStartPoint().then((function(n){var r={x:n.x,y:n.y,heading:null==n?void 0:n.heading},o=c.pathwayMarker.lastPosition;f.checkCycleRouting({start:r,end:o}).then((function(n){n.isCycle?(h(e),null==t||t.deactiveAll()):(v.setCurrentRouteMix({currentRouteLoop:{currentRouteLoopState:!1}}),(0,i.yw)({type:"error",content:d("NoLoopMessage")}))}))})):(0,i.yw)({type:"error",content:d("NoWayPointMessage")});break;case pe.Iz.FAVORITE:h(e),null==t||t.deactiveAll()}}}),[t,n,g]),S=g===pe.Iz.RELOCATE?r.createElement(Be,null):r.createElement(Ke,{functionalItemNoActiveText:_e.FunctionalRelocateNoActive}),x=g===pe.Iz.WAYPOINT?r.createElement(He,null):r.createElement(Ke,{functionalItemNoActiveText:_e.FunctionaWayNoActive}),P=g===pe.Iz.LOOP?r.createElement(Ye,null):r.createElement(Ke,{functionalItemNoActiveText:_e.FunctionalLoopNoActive}),j=g===pe.Iz.FAVORITE?r.createElement(he,{activeOrigin:pe.yP.FROM_FULLSCREEN}):r.createElement(Ke,{functionalItemNoActiveText:_e.FunctionalFavoriteNoActive});return r.createElement("div",{className:p["routing-editing-function-area"]},r.createElement("div",{className:p["routing-editing-function-area__group"]},r.createElement(Ie,{content:S,trigger:"hover",placement:"right",mouseLeaveDelay:.5,destroyTooltipOnHide:!0,rootClassName:y(g===pe.Iz.RELOCATE?p["custom-popover-functinal"]:p["custom-popover-ordinary"])},r.createElement("div",null,r.createElement(De,{functionalName:pe.Iz.RELOCATE,checkedItem:g,onClick:O(pe.Iz.RELOCATE)}))),r.createElement(Ie,{content:x,trigger:"hover",placement:"right",mouseLeaveDelay:.5,destroyTooltipOnHide:!0,rootClassName:y(g===pe.Iz.WAYPOINT?p["custom-popover-functinal"]:p["custom-popover-ordinary"])},r.createElement("div",null,r.createElement(De,{functionalName:pe.Iz.WAYPOINT,checkedItem:g,onClick:O(pe.Iz.WAYPOINT)}))),r.createElement(Ie,{content:P,trigger:"hover",placement:"right",mouseLeaveDelay:.5,destroyTooltipOnHide:!0,rootClassName:y(g===pe.Iz.LOOP?p["custom-popover-functinal"]:p["custom-popover-ordinary"])},r.createElement("div",null,r.createElement(De,{functionalName:pe.Iz.LOOP,checkedItem:g,onClick:O(pe.Iz.LOOP)})))),r.createElement(Ie,{content:j,trigger:"hover",placement:"rightTop",destroyTooltipOnHide:!0,rootClassName:y(g===pe.Iz.FAVORITE?p["custom-popover-functinal"]:p["custom-popover-ordinary"])},r.createElement("div",null,r.createElement(De,{functionalName:pe.Iz.FAVORITE,checkedItem:g,onClick:O(pe.Iz.FAVORITE)}))))}const rt=r.memo(nt);var ot=function(e){return{type:ce,payload:e}},it=function(e){return{type:ue,payload:e}};function at(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function lt(){var e,t,n=(0,ye.x2)(),o=v(),a=(0,D.BH)((function(e){return{"routing-editing-op-con":{"& > button:nth-of-type(1)":{width:"72px",height:"32px",marginRight:"16px",backgroundColor:"transparent",border:"1px solid rgba(124,136,153,1)","&:hover":{color:"#3288FA",backgroundColor:"transparent",border:"1px solid #3288FA"},"&:active":{color:"#1252C0",backgroundColor:"#1252C0",border:"1px solid #1252C0"}},"& > button:nth-of-type(2)":{width:"114px",height:"32px"}}}}))(),l=a.classes,c=(a.cx,(0,P.R)()),u=(0,C.Z)().mainApi,s=(e=me(),t=1,function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i,a,l=[],c=!0,u=!1;try{if(i=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=i.call(n)).done)&&(l.push(r.value),l.length!==t);c=!0);}catch(e){u=!0,o=e}finally{try{if(!c&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}(e,t)||function(e,t){if(e){if("string"==typeof e)return at(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?at(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}())[0],f=s.routingEditor,m=s.routeManager,p=(0,w.$G)("routeEditing").t;return r.createElement("div",{className:l["routing-editing-op-con"]},r.createElement(i.zx,{onClick:function(){i.u_.confirm({content:p("cancelEditingRouting"),icon:r.createElement("span",null),onOk:function(){o("/"),c.exitFullScreen()},okText:p("modalConfirmYes"),cancelText:p("modalConfirmNo")})}},p("cancel")),r.createElement(i.zx,{onClick:function(){var e,t=c.panelId,r=f.initiationMarker.initiationMarkerPosition,i={initialPoint:r,wayPoint:f.pathwayMarker.pathWatMarkerPosition,cycleNumber:null===(e=m.currentRouteMix.getCurrentRouteMix().currentRouteLoop)||void 0===e?void 0:e.currentRouteLoopTimes};r||u.getStartPoint().then((function(e){i.initialPoint=e})),m.currentRouteMix.setCurrentRouteMix({currentRouteLoop:{currentRouteLoopState:!1}}),n.emit(Y.l.SimControlRoute,{panelId:t,routeInfo:i}),o("/"),c.exitFullScreen()}},p("saveEditing")))}function ct(e){return ct="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ct(e)}function ut(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function st(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ut(Object(n),!0).forEach((function(t){var r,o,i;r=e,o=t,i=n[t],(o=function(e){var t=function(e,t){if("object"!==ct(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==ct(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===ct(t)?t:String(t)}(o))in r?Object.defineProperty(r,o,{value:i,enumerable:!0,configurable:!0,writable:!0}):r[o]=i})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ut(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function ft(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i,a,l=[],c=!0,u=!1;try{if(i=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=i.call(n)).done)&&(l.push(r.value),l.length!==t);c=!0);}catch(e){u=!0,o=e}finally{try{if(!c&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}(e,t)||function(e,t){if(e){if("string"==typeof e)return mt(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?mt(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function mt(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function pt(){var e=(0,w.$G)("routeEditing").t,t=ft(me(),2),n=t[0].routeManager,a=t[1],c=n.currentRouteManager,u=(0,P.R)().registerFullScreenHooks,s=(0,C.Z)(),f=s.mainApi,m=s.isMainConnected,p=ft((0,r.useState)(l().generate),1)[0],y=ft((0,r.useState)((function(){return new o.n(p)})),1)[0],d=ft((0,r.useState)((function(){return new Se.Z})),1)[0],b=ft((0,r.useState)(null),2),h=b[0],O=b[1],S=function(e){h!==e&&O(e)},x=(0,E.Z)().classes,j=ft((0,g.Mq)(),1)[0],R=v();(0,r.useEffect)((function(){u({afterExitFullScreen:function(){R("/")}})}),[]),(0,r.useEffect)((function(){y.init(),y.view.changeViewType(Pe.MAP),a(ot({routingEditor:y}))}),[]);var N=(0,r.useCallback)((function(e){var t,n;null==f||f.getMapElementIds({point:{x:null!==(t=e.x)&&void 0!==t?t:0,y:null!==(n=e.y)&&void 0!==n?n:0},radius:400}).then((function(e){if(!Se.Z.isMapElementIdsEmpty(e)){var t=ft(d.getMapElement(e),2),n=(t[0],t[1]);f.getMapElementsByIds(n).then((function(e){d.updateMapElement(e),null==y||y.updateMap(d.getAllMapElements()),y.render()}))}}))}),[m]);return(0,r.useEffect)((function(){var e;return y.removeAll(),y.deactiveAll(),d.clear(),null==f||f.getMapElementIds({radius:200}).then((function(t){var r=ft(d.getMapElement(t),2),o=(r[0],r[1]);f.getMapElementsByIds(o).then((function(t){if(d.updateMapElement(t),Se.Z.findFirstMapElement(o))try{null==y||y.updateMap(t),y.render(),y.setCameraUpdateCallback(N),null==f||f.getStartPoint().then((function(t){y.coordinates.initialize(t.x,t.y),y.initiationMarker.init(t),N(new xe.Vector3(t.x,t.y,0)),e=n.currentRouteManager.subScribeCurrentRoute((function(e){var t=e.routeOrigin,n=e.routePoint;if(console.log("currentRoute",e),t===oe.CREATING_ROUTE){var r=n.routeInitialPoint,o=n.routeWayPoint;y.initiationMarker.init(r),y.pathwayMarker.init(o)}}))}))}catch(e){console.error("getMapElementById error",e)}}))})),function(){var t;null===(t=e)||void 0===t||t.unsubscribe()}}),[m,j.currentMap]),(0,r.useEffect)((function(){var t=c.subScribeCurrentCheckPoint((function(t){if(m){var n=t,r=t.type;delete n.type,f.checkRoutingPoint({point:st(st({},n),{},{id:0})}).then((function(t){t.isLegal?r===ie.INITIAL_POINT&&f.setStartPoint({point:st({},n)}):r===ie.WAY_POINT&&(y.pathwayMarker.undo(),(0,i.yw)({type:"error",content:e("checkPointTooltip")}))}))}}));return function(){t.unsubscribe()}}),[m]),r.createElement("div",{className:x["viz-container"]},r.createElement("div",{id:p,className:x["web-gl"]}),r.createElement(rt,{carviz:y,activeName:h,changeActiveName:S}),r.createElement("div",{className:x["view-btn-container"]},r.createElement(V.Z,{carviz:y,activeName:h,changeActiveName:S})),r.createElement("div",{className:x["view-ope-container"]},r.createElement(lt,null)))}var yt=n(41857),dt=n(17063);function vt(e){return vt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},vt(e)}function bt(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,(void 0,o=function(e,t){if("object"!==vt(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==vt(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(r.key),"symbol"===vt(o)?o:String(o)),r)}var o}var gt=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.currentRouteSubject=new yt.X(t),this.currentCheckPointSubject=new dt.x}var t,n;return t=e,(n=[{key:"getCurrentRoute",value:function(){return this.currentRouteSubject.value}},{key:"setCurrentRoute",value:function(e){this.currentRouteSubject.next(e)}},{key:"subScribeCurrentRoute",value:function(e){return this.currentRouteSubject.subscribe(e)}},{key:"setScribeCurrentCheckPoint",value:function(e){this.currentCheckPointSubject.next(e)}},{key:"subScribeCurrentCheckPoint",value:function(e){return this.currentCheckPointSubject.subscribe(e)}}])&&bt(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();function ht(e){return ht="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ht(e)}function Et(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,(void 0,o=function(e,t){if("object"!==ht(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==ht(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(r.key),"symbol"===ht(o)?o:String(o)),r)}var o}var wt=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.currentRouteLoop=t.currentRouteLoop}var t,n;return t=e,(n=[{key:"getCurrentRouteMix",value:function(){return{currentRouteLoop:this.currentRouteLoop}}},{key:"setCurrentRouteMix",value:function(e){e.currentRouteLoop&&(this.currentRouteLoop=e.currentRouteLoop)}}])&&Et(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();function Ot(e){return Ot="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ot(e)}function St(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,(void 0,o=function(e,t){if("object"!==Ot(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==Ot(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(r.key),"symbol"===Ot(o)?o:String(o)),r)}var o}function xt(e,t,n){return t&&St(e.prototype,t),n&&St(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}var Pt=xt((function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.currentRouteManager=new gt(t),this.currentRouteMix=new wt(n)}));function Ct(e){return Ct="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ct(e)}function jt(e,t,n){return(t=function(e){var t=function(e,t){if("object"!==Ct(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==Ct(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===Ct(t)?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Rt(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i,a,l=[],c=!0,u=!1;try{if(i=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=i.call(n)).done)&&(l.push(r.value),l.length!==t);c=!0);}catch(e){u=!0,o=e}finally{try{if(!c&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}(e,t)||function(e,t){if(e){if("string"==typeof e)return Nt(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Nt(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Nt(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function kt(){var e=(0,P.R)(),t=(Rt((0,g.Mq)(),1)[0],Rt((0,r.useState)(l().generate),1)[0]),n=e.initSubscription,a=e.updateChannel,c=(0,E.Z)().classes,u=Rt((0,r.useState)("D"),2),s=u[0],f=u[1],m=Rt((0,r.useState)((function(){return new o.G(t)})),1)[0],p=(0,r.useRef)(),y=function e(){m.render(),p.current=requestAnimationFrame(e)};(0,r.useEffect)((function(){var e;return n((jt(e={},h.DU.SIM_WORLD,{consumer:function(e){e&&0!==Object.keys(e).length&&m.updateData(e)}}),jt(e,h.DU.Map,{consumer:function(e){e&&(null==m||m.updateMap(e))}}),jt(e,h.DU.POINT_CLOUD,{consumer:function(e){e&&(null==m||m.updatePointCloud(e))}}),e)),y(),function(){var e=p.current;e&&cancelAnimationFrame(e)}}),[]),(0,r.useEffect)((function(){m.init();var e=x();localStorage.setItem("layerMenuParams",JSON.stringify(e)),m.option.updateLayerOption(S(e),"vehicle"),e.Perception.pointCloud.currentVisible&&setTimeout((function(){a({name:h.DU.POINT_CLOUD,needChannel:!1})}),0),document.addEventListener("keydown",(function(e){var t,n;(e.metaKey&&(0,z.V)()||e.ctrlKey&&(0,z.K)())&&"Equal"===e.code&&(e.preventDefault(),null===(t=m.view)||void 0===t||t.updateViewDistance(-10)),(e.metaKey&&(0,z.V)()||e.ctrlKey&&(0,z.K)())&&"Minus"===e.code&&(e.preventDefault(),null===(n=m.view)||void 0===n||n.updateViewDistance(10))}))}),[]);var d=(0,C.Z)().metadata,v=(0,r.useMemo)((function(){var e,t=null===(e=d.find((function(e){return e.dataName===h.DU.POINT_CLOUD})))||void 0===e||null===(e=e.channels)||void 0===e?void 0:e.filter((function(e){return e.includes("compensator")||e.includes("fusion")})).sort((function(e){return e.includes("compensator")?-1:1}));return Array.isArray(t)?t[0]:""}),[d]),b=(0,r.useMemo)((function(){return x().Perception.pointCloud.currentVisible}),[]);return(0,r.useEffect)((function(){b&&a({name:h.DU.POINT_CLOUD,needChannel:!0,channel:v})}),[d,b,v]),r.createElement("div",{className:c["viz-container"]},r.createElement("div",{id:t,className:c["web-gl"]}),r.createElement("div",{className:c["viz-btn-container"]},r.createElement(V.Z,{carviz:m},r.createElement(i.J2,{placement:"leftTop",content:r.createElement(M,{carviz:m,pointCloudFusionChannel:v}),trigger:"click"},r.createElement("span",{className:c["viz-btn-item"]},r.createElement(i.Le,null))),r.createElement(i.J2,{overlayClassName:c["layer-menu-popover"],placement:"leftBottom",content:r.createElement(T.Z,{carviz:m,setCurrentView:f}),trigger:"click",style:{padding:"0 !importent"}},r.createElement("span",{className:c["viz-btn-item"]},s)))),r.createElement(Oe,null))}function It(){var e=Rt(me(),2)[1],t={routeOrigin:oe.EDITING_ROUTE,routePoint:{routeInitialPoint:null,routeWayPoint:[]}},n={currentRouteLoop:{currentRouteLoopState:!1}};return(0,r.useEffect)((function(){e(it({routeManager:new Pt(t,n)}))}),[]),r.createElement(y,{initialPath:"/"},r.createElement(b,{path:"/",style:{minWidth:"244px",height:"100%",position:"relative"}},r.createElement(kt,null)),r.createElement(d,{path:"/routing",style:{width:"100%",height:"100%"}},r.createElement(pt,null)))}function At(){return r.createElement(fe,null,r.createElement(It,null))}function Ft(e){var t=(0,r.useMemo)((function(){return(0,L.Z)({PanelComponent:At,panelId:e.panelId,subscribeInfo:[{name:h.DU.SIM_WORLD,needChannel:!1},{name:h.DU.Map,needChannel:!1}]})}),[]);return r.createElement(t,e)}At.displayName="VehicleViz";const Mt=r.memo(Ft)}}]);