"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[681],{1670:(e,n,t)=>{t.r(n),t.d(n,{default:()=>I});var i=t(21902),r=t(20288),l=t(4994),a=t(54067),o=t(97265),u=t.n(o),c=t(56733),s={Perception:{polygon:{defaultVisible:!0,currentVisible:!0,vizKey:"polygon"},boundingbox:{defaultVisible:!1,currentVisible:!1,vizKey:"boundingbox"},pointCloud:{defaultVisible:!1,currentVisible:!1,vizKey:"pointCloud"},unknownMovable:{defaultVisible:!0,currentVisible:!0,vizKey:"unknownMovable"},vehicle:{defaultVisible:!0,currentVisible:!0,vizKey:"vehicle"},unknownStationary:{defaultVisible:!0,currentVisible:!0,vizKey:"unknownUnMovable"},pedestrian:{defaultVisible:!0,currentVisible:!0,vizKey:"pedestrian"},unknown:{defaultVisible:!0,currentVisible:!0,vizKey:"unknown"},bicycle:{defaultVisible:!0,currentVisible:!0,vizKey:"bicycle"},cipv:{defaultVisible:!0,currentVisible:!0,vizKey:"cipv"},velocity:{defaultVisible:!0,currentVisible:!0,vizKey:"obstacleVelocity"},heading:{defaultVisible:!0,currentVisible:!0,vizKey:"obstacleHeading"},id:{defaultVisible:!0,currentVisible:!0,vizKey:"obstacleId"},distanceAndSpeed:{defaultVisible:!0,currentVisible:!0,vizKey:"obstacleDistanceAndSpeed"},laneMarker:{defaultVisible:!1,currentVisible:!1,vizKey:"laneMarker"},lidarSensor:{defaultVisible:!1,currentVisible:!1,vizKey:"lidarSensor"},radarSensor:{defaultVisible:!1,currentVisible:!1,vizKey:"radarSensor"},cameraSensor:{defaultVisible:!1,currentVisible:!1,vizKey:"cameraSensor"},v2x:{defaultVisible:!1,currentVisible:!1,vizKey:"v2x"}},Prediction:{priority:{defaultVisible:!0,currentVisible:!0,vizKey:"obstaclePriority"},majorPredictionLine:{defaultVisible:!0,currentVisible:!0,vizKey:"majorPredictionLine"},gaussianInfo:{defaultVisible:!1,currentVisible:!1,vizKey:"gaussianInfo"},minorPredictionLine:{defaultVisible:!0,currentVisible:!0,vizKey:"minorPredictionLine"},interactiveTag:{defaultVisible:!0,currentVisible:!0,vizKey:"obstacleInteractiveTag"}},Routing:{routingLine:{defaultVisible:!0,currentVisible:!0,vizKey:"routingLine"}},Decision:{mainDecision:{defaultVisible:!0,currentVisible:!0,vizKey:"mainDecision"},obstacleDecision:{defaultVisible:!0,currentVisible:!0,vizKey:"obstacleDecision"}},Planning:{planningCar:{defaultVisible:!1,currentVisible:!1,vizKey:"planningCar"},planningTrajectory:{defaultVisible:!0,currentVisible:!0,vizKey:"planningTrajectory"}},Position:{localization:{defaultVisible:!0,currentVisible:!0,vizKey:"localization"},gps:{defaultVisible:!1,currentVisible:!1,vizKey:"gps"},shadow:{defaultVisible:!1,currentVisible:!1,vizKey:"shadow"}},Map:{crosswalk:{defaultVisible:!0,currentVisible:!0,vizKey:"crosswalk"},clearArea:{defaultVisible:!0,currentVisible:!0,vizKey:"clearArea"},junction:{defaultVisible:!1,currentVisible:!1,vizKey:"junction"},pncJunction:{defaultVisible:!1,currentVisible:!1,vizKey:"pncJunction"},lane:{defaultVisible:!0,currentVisible:!0,vizKey:"lane"},road:{defaultVisible:!1,currentVisible:!1,vizKey:"road"},signal:{defaultVisible:!0,currentVisible:!0,vizKey:"signal"},stopSign:{defaultVisible:!0,currentVisible:!0,vizKey:"stopSign"},yieldSign:{defaultVisible:!0,currentVisible:!0,vizKey:"yieldSign"},speedBump:{defaultVisible:!0,currentVisible:!0,vizKey:"speedBump"},parkingSpace:{defaultVisible:!0,currentVisible:!0,vizKey:"parkingSpace"},parkingSpaceId:{defaultVisible:!1,currentVisible:!1,vizKey:"parkingSpaceId"},laneId:{defaultVisible:!1,currentVisible:!1,vizKey:"laneId"}}},f=function(e){var n={};return Object.keys(e).forEach((function(t){var i=e[t];Object.keys(i).forEach((function(e){var r=i[e];n[t]=n[t]||{},n[t][r.vizKey]=r.currentVisible}))})),n},b=function(){var e=localStorage.getItem("layerMenuParams");return e?JSON.parse(e):s},d=t(52007),y=t(58938),m=t(16125);function p(e){return p="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},p(e)}function v(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);n&&(i=i.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,i)}return t}function g(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?v(Object(t),!0).forEach((function(n){V(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):v(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function V(e,n,t){return(n=function(e){var n=function(e,n){if("object"!==p(e)||null===e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var i=t.call(e,"string");if("object"!==p(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===p(n)?n:String(n)}(n))in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function h(e,n){return function(e){if(Array.isArray(e))return e}(e)||function(e,n){var t=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=t){var i,r,l,a,o=[],u=!0,c=!1;try{if(l=(t=t.call(e)).next,0===n){if(Object(t)!==t)return;u=!1}else for(;!(u=(i=l.call(t)).done)&&(o.push(i.value),o.length!==n);u=!0);}catch(e){c=!0,r=e}finally{try{if(!u&&null!=t.return&&(a=t.return(),Object(a)!==a))return}finally{if(c)throw r}}return o}}(e,n)||function(e,n){if(e){if("string"==typeof e)return S(e,n);var t=Object.prototype.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(e):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?S(e,n):void 0}}(e,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function S(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,i=new Array(n);t<n;t++)i[t]=e[t];return i}function O(e){var n,t,r=(0,c.Z)(),o=r.classes,u=r.cx,p=e.carviz,v=e.pointCloudFusionChannel,S=(0,a.$G)("layerMenu").t,O=(0,d.R)(),z=O.updateChannel,K=O.closeSubcription,E=(0,m.Z)().metadata,P=(0,i.useCallback)((function(e){if("pointCloud"===e){var n,t=null===(n=E.find((function(e){return e.dataName===y.DU.POINT_CLOUD})))||void 0===n?void 0:n.channels;if(Array.isArray(t)){var i=t.some((function(e){return e.includes("compensator")})),r=t.some((function(e){return e.includes("fusion")}));return!(i||r)}}return!1}),[E]),w=b();localStorage.setItem("layerMenuParams",JSON.stringify(w)),p.option.updateLayerOption(f(w),"vehicle");var C=h((0,i.useState)(w),2),N=C[0],k=C[1],D=h((0,i.useState)(Object.keys(N)),1)[0],j=h((0,i.useState)(D[0]),2),I=j[0],M=j[1],L=h((0,i.useState)(N[I]),2),A=L[0],U=L[1];return i.createElement("div",{className:o["layer-menu-container"]},i.createElement("div",{className:o["layer-menu-header"]},i.createElement("div",{className:o["layer-menu-header-left"]},S("layerMenu")),i.createElement("div",{className:o["layer-menu-header-right"]},i.createElement("div",{className:o["layer-menu-header-reset-btn"],onClick:function(){k((function(){return s})),p.option.updateLayerOption(f(s),"vehicle"),localStorage.setItem("layerMenuParams",JSON.stringify(s))}},S("restoreDefaultSettings")))),i.createElement("div",{className:o["layer-menu-content"]},i.createElement("div",{className:o["layer-menu-content-left"]},D.map((function(e){return i.createElement("li",{key:e,className:u(o["layer-menu-content-left-li"],V({},o["li-active"],I===e)),onClick:function(){M(e),U(N[e])}},i.createElement("span",null,S(e)))}))),i.createElement("div",{className:o["layer-menu-content-right"]},"Perception"===I&&i.createElement(i.Fragment,null,i.createElement("li",{className:o["layer-menu-content-right-li"]},i.createElement("span",{className:o["layer-menu-content-right-switch"]},i.createElement(l.Y8,{checked:null==N||null===(n=N.Perception)||void 0===n||null===(n=n.polygon)||void 0===n?void 0:n.currentVisible,onChange:function(e){if(e.target.checked){var n=g(g({},N.Perception),{},{polygon:g(g({},N.Perception.polygon),{},{currentVisible:!0}),boundingbox:g(g({},N.Perception.boundingbox),{},{currentVisible:!1})}),t=g(g({},N),{},V({},I,n));U((function(){return n})),k((function(){return t})),p.option.updateLayerOption(f(t),"vehicle"),localStorage.setItem("layerMenuParams",JSON.stringify(t))}}})),i.createElement("span",{className:o["layer-menu-content-right-label"]},S("polygon"))),i.createElement("li",{className:o["layer-menu-content-right-li"]},i.createElement("span",{className:o["layer-menu-content-right-switch"]},i.createElement(l.Y8,{checked:null==N||null===(t=N.Perception)||void 0===t||null===(t=t.boundingbox)||void 0===t?void 0:t.currentVisible,onChange:function(e){if(e.target.checked){var n=g(g({},N.Perception),{},{polygon:g(g({},N.Perception.polygon),{},{currentVisible:!1}),boundingbox:g(g({},N.Perception.boundingbox),{},{currentVisible:!0})}),t=g(g({},N),{},V({},I,n));U((function(){return n})),k((function(){return t})),p.option.updateLayerOption(f(t),"vehicle"),localStorage.setItem("layerMenuParams",JSON.stringify(t))}}})),i.createElement("span",{className:o["layer-menu-content-right-label"]},S("boundingbox"))),i.createElement("div",{className:o["layer-menu-horizontal-line"]})),Object.keys(A).map((function(e){var n=(N[I][e]||{}).currentVisible;return"polygon"!==e&&"boundingbox"!==e&&i.createElement("li",{className:o["layer-menu-content-right-li"],key:e},i.createElement("span",{className:o["layer-menu-content-right-switch"]},i.createElement(l.XZ,{checked:n,disabled:P(e),defaultChecked:n,onChange:function(n){var t=n.target.checked,i=g(g({},N[I]),{},V({},e,g(g({},N[I][e]),{},{currentVisible:t}))),r=g(g({},N),{},V({},I,i));U((function(){return i})),k((function(){return r})),p.option.updateLayerOption(f(r),"vehicle"),localStorage.setItem("layerMenuParams",JSON.stringify(r)),t&&"pointCloud"===e&&!P(e)&&v&&z({name:y.DU.POINT_CLOUD,needChannel:!0,channel:v}),t||"pointCloud"!==e||(p.removePointCloud(),K(y.DU.POINT_CLOUD))}})),i.createElement("span",{className:o["layer-menu-content-right-label"]},S(e)))})))))}var z=t(79424),K=t(51999),E=t(80151),P=t(2629),w=t(39111);function C(e){return C="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},C(e)}function N(e,n,t){return(n=function(e){var n=function(e,n){if("object"!==C(e)||null===e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var i=t.call(e,"string");if("object"!==C(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===C(n)?n:String(n)}(n))in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function k(e,n){return function(e){if(Array.isArray(e))return e}(e)||function(e,n){var t=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=t){var i,r,l,a,o=[],u=!0,c=!1;try{if(l=(t=t.call(e)).next,0===n){if(Object(t)!==t)return;u=!1}else for(;!(u=(i=l.call(t)).done)&&(o.push(i.value),o.length!==n);u=!0);}catch(e){c=!0,r=e}finally{try{if(!u&&null!=t.return&&(a=t.return(),Object(a)!==a))return}finally{if(c)throw r}}return o}}(e,n)||function(e,n){if(e){if("string"==typeof e)return D(e,n);var t=Object.prototype.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(e):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?D(e,n):void 0}}(e,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function D(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,i=new Array(n);t<n;t++)i[t]=e[t];return i}function j(){var e=(0,d.R)(),n=k((0,E.Mq)(),1)[0],t=k((0,i.useState)(u().generate),1)[0],o=e.initSubscription,s=(e.logger,e.updateChannel),p=(0,c.Z)().classes,v=k((0,i.useState)("D"),2),g=v[0],V=v[1],h=k((0,i.useState)((function(){return new r.Z(t)})),1)[0];(0,a.$G)("viewMenu").t,(0,i.useEffect)((function(){var e;o((N(e={},y.DU.SIM_WORLD,{consumer:function(e){e&&0!==Object.keys(e).length&&(h.updateData(e),h.render())}}),N(e,y.DU.Map,{consumer:function(e){if(e){var n={map:e};null==h||h.updateData(n),h.render()}}}),N(e,y.DU.POINT_CLOUD,{consumer:function(e){if(e){var n={pointCloud:e};null==h||h.updateData(n),h.render()}}}),e))}),[]),(0,i.useEffect)((function(){h.init();var e=b();localStorage.setItem("layerMenuParams",JSON.stringify(e)),h.option.updateLayerOption(f(e),"vehicle"),e.Perception.pointCloud.currentVisible&&setTimeout((function(){s({name:y.DU.POINT_CLOUD,needChannel:!1})}),0),document.addEventListener("keydown",(function(e){var n,t;(e.metaKey&&(0,w.V)()||e.ctrlKey&&(0,w.K)())&&"Equal"===e.code&&(e.preventDefault(),null===(n=h.view)||void 0===n||n.updateViewDistance(-10)),(e.metaKey&&(0,w.V)()||e.ctrlKey&&(0,w.K)())&&"Minus"===e.code&&(e.preventDefault(),null===(t=h.view)||void 0===t||t.updateViewDistance(10))}))}),[]);var S=(0,m.Z)().metadata,P=(0,i.useMemo)((function(){var e,n=null===(e=S.find((function(e){return e.dataName===y.DU.POINT_CLOUD})))||void 0===e||null===(e=e.channels)||void 0===e?void 0:e.filter((function(e){return e.includes("compensator")||e.includes("fusion")})).sort((function(e){return e.includes("compensator")?-1:1}));return Array.isArray(n)?n[0]:""}),[S]),C=(0,i.useMemo)((function(){return b().Perception.pointCloud.currentVisible}),[]);return(0,i.useEffect)((function(){C&&s({name:y.DU.POINT_CLOUD,needChannel:!0,channel:P})}),[S,C,P]),(0,i.useEffect)((function(){null==h||h.removeAll()}),[n.currentRecordId]),i.createElement("div",{className:p["viz-container"]},i.createElement("div",{id:t,className:p["web-gl"]}),i.createElement("div",{className:p["viz-btn-container"]},i.createElement(l.J2,{placement:"leftTop",content:i.createElement(O,{carviz:h,pointCloudFusionChannel:P}),trigger:"click"},i.createElement("span",{className:p["viz-btn-item"]},i.createElement(l.Le,null))),i.createElement(l.J2,{overlayClassName:p["layer-menu-popover"],placement:"leftBottom",content:i.createElement(z.Z,{carviz:h,setCurrentView:V}),trigger:"click",style:{padding:"0 !importent"}},i.createElement("span",{className:p["viz-btn-item"]},g)),i.createElement(K.Z,{carviz:h})))}function I(e){var n=(0,i.useMemo)((function(){return(0,P.Z)(j,e.panelId,[{name:y.DU.SIM_WORLD,needChannel:!1},{name:y.DU.Map,needChannel:!1}])}),[]);return i.createElement(n,e)}j.displayName="VehicleViz"}}]);
//# sourceMappingURL=681.70feeb3c2eb3a515e43b.js.map