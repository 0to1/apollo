load("@rules_cc//cc:defs.bzl", "cc_library", "cc_binary")
load("//tools:apollo_package.bzl", "apollo_package")
load("//tools:cpplint.bzl", "cpplint")

package(default_visibility = ["//visibility:public"])

cc_library(
    name = "perception_gflags",
    srcs = ["libperception_gflags.so"],
    hdrs = ["perception_gflags.h"],
    deps = [
        "@com_github_gflags_gflags//:gflags",
    ],
)

cc_binary(
    name = "libperception_gflags.so",
    srcs = [
        "perception_gflags.cc",
        "perception_gflags.h",
    ],
    linkshared = True,
    linkstatic = True,
    deps = [
        "@com_github_gflags_gflags//:gflags",
    ],
)

cc_library(
    name = "util",
    srcs = ["lib_util.so"],
    hdrs = ["util.h"],
    deps = [
        "//cyber",
    ],
)

cc_binary(
    name = "lib_util.so",
    srcs = [
        "util.cc",
        "util.h",
    ],
    linkshared = True,
    linkstatic = True,
    deps = [
        "//cyber",
    ],
)

cc_binary(
    name = "libperception_common.so",
    linkshared = True,
    linkstatic = True,
    visibility = ["//visibility:public"],
    deps = [
        "//modules/perception/common/algorithm/geometry:basic",
        "//modules/perception/common/algorithm/geometry:camera_homography",
        "//modules/perception/common/algorithm/geometry:common",
        "//modules/perception/common/algorithm/geometry:convex_hull_2d",
        "//modules/perception/common/algorithm/geometry:roi_filter",
        "//modules/perception/common/algorithm/graph:conditional_clustering",
        "//modules/perception/common/algorithm/graph:connected_component_analysis",
        "//modules/perception/common/algorithm/graph:disjoint_set",
        "//modules/perception/common/algorithm/graph:gated_hungarian_bigraph_matcher",
        "//modules/perception/common/algorithm/graph:graph",
        "//modules/perception/common/algorithm/graph:graph_segmentor",
        "//modules/perception/common/algorithm/graph:hungarian_optimizer",
        "//modules/perception/common/algorithm/graph:secure_matrix",
        "//modules/perception/common/algorithm/i_lib:i_lib",
        "//modules/perception/common/algorithm/i_lib/algorithm:i_sort",
        "//modules/perception/common/algorithm/i_lib/core:core",
        "//modules/perception/common/algorithm/i_lib/da:i_ransac",
        "//modules/perception/common/algorithm/i_lib/geometry:i_plane",
        "//modules/perception/common/algorithm/i_lib/pc:i_ground",
        "//modules/perception/common/algorithm/i_lib/pc:i_struct_s",
        "//modules/perception/common/algorithm/i_lib/pc:i_util",
        "//modules/perception/common/algorithm/image_processing:hough_transfer",
        "//modules/perception/common/algorithm/io:io_util",
        "//modules/perception/common/algorithm/point_cloud_processing:point_cloud_processing",
        "//modules/perception/common/algorithm/point_cloud_processing:point_cloud_processing_test",
        "//modules/perception/common/algorithm/sensor_manager:sensor_manager",
        "//modules/perception/common/base:base",
        "//modules/perception/common/base:base_type",
        "//modules/perception/common/base:blob",
        "//modules/perception/common/base:box",
        "//modules/perception/common/base:camera",
        "//modules/perception/common/base:common",
        "//modules/perception/common/base:distortion_model",
        "//modules/perception/common/base:frame",
        "//modules/perception/common/base:image",
        "//modules/perception/common/base:impending_collision_edge",
        "//modules/perception/common/base:nms",
        "//modules/perception/common/base:object",
        "//modules/perception/common/base:object_pool",
        "//modules/perception/common/base:object_pool_types",
        "//modules/perception/common/base:omnidirectional_model",
        "//modules/perception/common/base:point",
        "//modules/perception/common/base:point_cloud",
        "//modules/perception/common/base:point_cloud_util",
        "//modules/perception/common/base:polynomial",
        "//modules/perception/common/base:syncedmem",
        "//modules/perception/common/base:traffic_light",
        "//modules/perception/common/base/test:test_helper",
        "//modules/perception/common/camera/common:camera_frame",
        "//modules/perception/common/camera/common:camera_ground_plane",
        "//modules/perception/common/camera/common:camera_preprocess_general_util",
        "//modules/perception/common/camera/common:cipv_camera",
        "//modules/perception/common/camera/common:common",
        "//modules/perception/common/camera/common:data_provider",
        "//modules/perception/common/camera/common:global_config",
        "//modules/perception/common/camera/common:lane_object",
        "//modules/perception/common/camera/common:math_functions",
        "//modules/perception/common/camera/common:object_template_manager",
        "//modules/perception/common/camera/common:pose",
        "//modules/perception/common/camera/common:timer",
        "//modules/perception/common/camera/common:trafficlight_frame",
        "//modules/perception/common/camera/common:twod_threed_util",
        "//modules/perception/common/camera/common:undistortion_handler",
        "//modules/perception/common/camera/common:util",
        "//modules/perception/common/hdmap:hdmap_input",
        "//modules/perception/common/inference:inference_factory",
        "//modules/perception/common/inference:inference_lib",
        "//modules/perception/common/inference:layer_lib",
        "//modules/perception/common/inference/libtorch:torch_net",
        "//modules/perception/common/inference/onnx:libtorch_obstacle_detector",
        "//modules/perception/common/inference/onnx:onnx_obstacle_detector",
        "//modules/perception/common/inference/operators:perception_inference_operators",
        "//modules/perception/common/inference/operators:perception_inference_operators_cuda",
        "//modules/perception/common/inference/paddlepaddle:paddle_net",
        "//modules/perception/common/inference/tensorrt:batch_stream",
        "//modules/perception/common/inference/tensorrt:entropy_calibrator",
        "//modules/perception/common/inference/tensorrt:rt_common",
        "//modules/perception/common/inference/tensorrt:rt_legacy",
        "//modules/perception/common/inference/tensorrt:rt_net",
        "//modules/perception/common/inference/tensorrt:rt_utils",
        "//modules/perception/common/inference/tensorrt/plugins:dfmb_psroi_align_plugin",
        "//modules/perception/common/inference/tensorrt/plugins:kernels_cuda",
        "//modules/perception/common/inference/tensorrt/plugins:perception_inference_tensorrt_plugins",
        "//modules/perception/common/inference/tensorrt/plugins:perception_inference_tensorrt_plugins_argmax_cuda",
        "//modules/perception/common/inference/tensorrt/plugins:perception_inference_tensorrt_plugins_leakyrelu_cuda",
        "//modules/perception/common/inference/tensorrt/plugins:perception_inference_tensorrt_plugins_slice_cuda",
        "//modules/perception/common/inference/tensorrt/plugins:perception_inference_tensorrt_plugins_softmax_cuda",
        "//modules/perception/common/inference/tensorrt/plugins:rcnn_proposal_plugin",
        "//modules/perception/common/inference/tensorrt/plugins:rpn_proposal_ssd_plugin",
        "//modules/perception/common/inference/utils:inference_binary_data_lib",
        "//modules/perception/common/inference/utils:inference_cuda_util_cuda_lib",
        "//modules/perception/common/inference/utils:inference_cuda_util_lib",
        "//modules/perception/common/inference/utils:inference_gemm_cuda_lib",
        "//modules/perception/common/inference/utils:inference_gemm_lib",
        "//modules/perception/common/inference/utils:inference_resize_cuda_lib",
        "//modules/perception/common/inference/utils:inference_resize_lib",
        "//modules/perception/common/inference/utils:inference_util_cuda_lib",
        "//modules/perception/common/inference/utils:inference_util_lib",
        "//modules/perception/common/lib/calibration_service/online_calibration_service:online_calibration_service",
        "//modules/perception/common/lib/calibrator/common:histogram_estimator",
        "//modules/perception/common/lib/calibrator/laneline:lane_based_calibrator",
        "//modules/perception/common/lib/calibrator/laneline:lane_struct_for_calib",
        "//modules/perception/common/lib/calibrator/laneline:laneline_calibrator",
        "//modules/perception/common/lib/config_manager:config_manager",
        "//modules/perception/common/lib/interface:base_calibration_service",
        "//modules/perception/common/lib/interface:base_calibrator",
        "//modules/perception/common/lib/interface:base_cipv",
        "//modules/perception/common/lib/interface:base_init_options",
        "//modules/perception/common/lib/registerer:registerer",
        "//modules/perception/common/lib/thread:concurrent_queue",
        "//modules/perception/common/lib/thread:thread",
        "//modules/perception/common/lidar/common:cloud_mask",
        "//modules/perception/common/lidar/common:common",
        "//modules/perception/common/lidar/common:config_util",
        "//modules/perception/common/lidar/common:feature_descriptor",
        "//modules/perception/common/lidar/common:lidar_error_code",
        "//modules/perception/common/lidar/common:lidar_frame",
        "//modules/perception/common/lidar/common:lidar_log",
        "//modules/perception/common/lidar/common:lidar_object_util",
        "//modules/perception/common/lidar/common:lidar_point_label",
        "//modules/perception/common/lidar/common:lidar_timer",
        "//modules/perception/common/lidar/common:object_sequence",
        "//modules/perception/common/lidar/common:pcl_util",
        "//modules/perception/common/lidar/common:pointcloud__util",
        "//modules/perception/common/lidar/scene_manager:scene_manager",
        "//modules/perception/common/lidar/scene_manager:scene_service",
        "//modules/perception/common/lidar/scene_manager/ground_service:ground_service",
        "//modules/perception/common/lidar/scene_manager/ground_service:ground_struct",
        "//modules/perception/common/lidar/scene_manager/roi_service:roi_service",
        "//modules/perception/common/onboard/inner_component_messages:camera_detection_component_messages",
        "//modules/perception/common/onboard/inner_component_messages:camera_inner_component_messages",
        "//modules/perception/common/onboard/inner_component_messages:inner_component_messages",
        "//modules/perception/common/onboard/inner_component_messages:lidar_inner_component_messages",
        "//modules/perception/common/onboard/inner_component_messages:traffic_inner_component_messages",
        "//modules/perception/common/onboard/msg_buffer:msg_buffer",
        "//modules/perception/common/onboard/msg_serializer:msg_serializer",

        "//modules/perception/common/proto:perception_config_schema_cc_proto",
        "//modules/perception/common/proto:model_info_cc_proto",
        "//modules/perception/common/proto:sensor_meta_schema_cc_proto",
        "//modules/perception/common/proto:motion_service_cc_proto",
        # "//modules/perception/common/proto:tracker_config_cc_proto",
        "//modules/perception/common/proto:rt_cc_proto",
        "//modules/perception/common/proto:perception_ultrasonic_cc_proto",
        "//modules/perception/common/proto:model_process_cc_proto",
        # "//modules/perception/common/proto:perception_config_cc_proto",
        # "//modules/perception/common/onboard/proto:lane_perception_component_cc_proto",
        # "//modules/perception/common/onboard/proto:radar_component_config_cc_proto",
        # "//modules/perception/common/onboard/proto:fusion_camera_detection_component_cc_proto",
        # "//modules/perception/common/onboard/proto:trafficlights_perception_component_cc_proto",
        # "//modules/perception/common/onboard/proto:fusion_component_config_cc_proto",
        # "//modules/perception/common/onboard/proto:lidar_component_config_cc_proto",
        "//modules/perception/common/onboard/transform_wrapper",
        "//modules/perception/common:perception_gflags",
        "//modules/perception/common/onboard/common_flags:common_flags",
        "//modules/perception/common:util",
    ],
)

apollo_package()
cpplint()
